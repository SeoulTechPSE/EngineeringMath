---
title: "Engineering Mathematics II"
subtitle: '<font color="red">Elliptic Partial Differential Equation</font>'
crossref: 
  eq-prefix: Eq.
format:
  revealjs: 
    menu: 
      numbers: true
    slide-level: 3
    slide-number: true
    smaller: false
    chalkboard: 
      buttons: true
    preview-links: auto
    logo: images/seoultech_logo.png
    css: styles.css
    pointer:
      pointerSize: 20
      color: 'red'
revealjs-plugins:
  - pointer 
#  - confetti
filters:
  - reveal-header
  - code-fullscreen     
jupyter: python3    
---

### Lesson 31. The Laplacian (an Intuitive Description)

* The <font color=red> Laplacian operator </font>

  $$ \nabla^2 =\frac{\partial^2}{\partial x^2} +\frac{\partial^2}{\partial y^2} +\frac{\partial^2}{\partial z^2}$$

  is probably the most important operator in mathematical physics. The question is, what does it mean and why should the sum of three second derivatives have anything to do with the laws of nature? 

. . .

* The answer to this lies in the fact that <font color=red>the Laplacian of a function allows us to compare the function at a point with the function at neighboring points</font>. It does what the second derivative did in one dimension and might be thought of as <font color=blue>a second derivative generalized to higher dimensions</font>

---

<center><img src="figures/pde03_figure01.jpg" alt="Intutive Meaning of the Laplacia" width="1000"/></center>

---

* The heat equation $~u_t=\alpha\nabla^2 u~$ measures temperature $u$, and the equation can be interpreted to mean that <font color=blue>the change in temperature with respect to time $u_t$ is proportional to $\nabla^2 u$</font>. That is, the temperature at a point is increasing if the temperature at that point is less than the average of the temperature on a circle around the point

. . .

* The wave equation $~u_{tt}=c^2\nabla^2 u~$ measures the displacement of a drumhead and can be interpreted to mean that <font color=blue>the acceleration (or force) of a point on the drumhead $u_{tt}$ is proportional to $\nabla^2 u$</font>. That is, the drumhead at a point is accelerating upward if the drumhead at that point is less than the average of its neighbors

---

* <font color=blue>Laplace's equation $\nabla^2 u = 0$ says that the solution $u$ is always equal to the average of its neighbors</font>. For example, $~$a steady-state, stretched rubber membrane satisfies Laplace's equation, hence, the height of the membrane at any point is equal to the average height of the membrane on a circle around the point

* <font color=blue>Poisson's equation $\nabla^2 u=f$</font>, $~$where $f$ is a function that depends only on the space variables

  * $\nabla^2 u=-\rho~$ describes the potential of an electrostatic field where $\rho$ represents a constant charge density
  * $\nabla^2 u =-g(x,y)~$ describes the steady-state temperature $u(x,y)$ due to a heat source $g(x,y)$ 

* <font color=blue>$\nabla^2 u +\lambda u =0~$ is known as the Helmholtz equation</font> which describes the fundamental shapes of a stretched membrane

---

#### Changing Coordinates

Before we start, $~$however, $~$let's review briefly the three major coordinate systems in two or three dimensions except for Cartesian system:

* Polar Coordinates

<center><img src="figures/pde03_figure02.jpg" alt="Polar Coordinate" width="400"/></center>

$$\begin{matrix}
     x = r\cos\theta \\ 
     y = r\sin\theta \, \\ 
    \end{matrix} \;\; \Rightarrow \;\;
    \begin{matrix}
      r^2 = x^2 + y^2 \;\;\;\\ 
      \tan\theta = y/x \;\;\;\;\;
    \end{matrix}$$

---

As an illustration, $~$we see how the two-dimensional Laplacian is transformed into polar coordinates:

$$\scriptsize \begin{align*}
 \nabla^2u &= u_{xx} +u_{yy}\\ 
 &\Updownarrow \\ 
 u_x = u_r r_x +u_\theta \theta_x &= u_r \cos\theta -u_\theta \frac{\sin\theta}{r}\\ 
 u_y = u_r r_y +u_\theta \theta_y &= u_r \sin\theta +u_\theta \frac{\cos\theta}{r}\\ 
 &\Downarrow \\
 u_{xx} = (u_x)_r r_x +(u_x)_\theta \theta_x =& 
  {\tiny\left( u_{rr} \cos\theta -u_{\theta r} \frac{\sin\theta}{r} +u_\theta\frac{\sin\theta}{r^2} \right) \cos\theta 
  -\left( u_{r\theta} \cos\theta -u_r\sin\theta -u_{\theta\theta} \frac{\sin\theta}{r} 
  -u_\theta \frac{\cos\theta}{r} \right) \frac{\sin\theta}{r} }\\
 u_{yy} = (u_y)_r r_y +(u_y)_\theta \theta_y =& 
 {\tiny  \left( u_{rr} \sin\theta +u_{\theta r} \frac{\cos\theta}{r} -u_\theta\frac{\cos\theta}{r^2} \right) \sin\theta 
  +\left( u_{r\theta} \sin\theta +u_r\cos\theta +u_{\theta\theta} \frac{\cos\theta}{r} 
  -u_\theta \frac{\sin\theta}{r} \right) \frac{\cos\theta}{r} } \\
  &\Updownarrow \\
  \color{red}{\nabla^2 u = u_{rr}} &\color{red}{+\frac{1}{r} u_r +\frac{1}{r^2} u_{\theta\theta}} 
\end{align*}$$

---

* Cylindrical Coordinates

<center> <img src="figures/pde03_figure03.jpg" alt="Cylindrical Coordinate" width="400"/> </center>

$$\begin{matrix}
     x = r\cos \theta \\ 
     y = r\sin \theta \, \\
     z = z \;\;\;\;\;\;\;
    \end{matrix} \;\; \Rightarrow \;\;
    \begin{matrix}
      r^2 = x^2 + y^2 \;\;\;\\ 
     \tan\theta = y/x  \;\;\;\;\; \\
      z=z\;\;\;\;\;\;\;\;\;\;\;\;
   \end{matrix}$$

 ---

Changing the Laplacian $\nabla^2 u = u_{xx} +u_{yy} +u_{zz}$ to cylindrical coordinates, $~$we can show

$$ \color{red}{\nabla^2 u = u_{rr} +\frac{1}{r} u_r +\frac{1}{r^2} u_{\theta\theta} +u_{zz}}$$

---

* Spherical Coordinates

<center><img src="figures/pde03_figure04.jpg" alt="Spherical Coordinate" width="400"/></center>

$$\begin{matrix}
  x = r\sin\phi\cos \theta \\ 
  y = r\sin\phi\sin \theta \, \\
  z = r\cos\phi \;\;\;\;\;\;\;
 \end{matrix} \;\; \Rightarrow \;\;
 \begin{matrix}
  r^2 = x^2 + y^2 +z^2 \;\;\;\\ 
  \cos\phi = z/r \;\;\;\;\;\;\;\;\;\;\;\;\\
  \tan\theta=y/x\;\;\;\;\;\;\;\;\;\;\;\;
 \end{matrix}$$

---

Finally, $~$ if we write the Laplacian in spherical coordinates, $~$ we have

$$\scriptsize \begin{align*}
 \nabla^2u &= u_{xx} +u_{yy} +u_{zz}\\ 
 &\Updownarrow \\ 
 u_x = u_r r_x +u_\phi \phi_x+u_\theta \theta_x &= u_r \sin\phi\cos\theta +u_\phi \frac{\cos\phi\cos\theta}{r}
  -u_\theta \frac{\sin\theta}{r\sin\phi}\\ 
 u_y = u_r r_y +u_\phi \phi_y+u_\theta \theta_y &= u_r \sin\phi\sin\theta +u_\phi \frac{\cos\phi\sin\theta}{r}
  +u_\theta \frac{\cos\theta}{r \sin\phi}\\ 
 u_z = u_r r_z +u_\phi \phi_z+u_\theta \theta_z &= u_r \cos\phi -u_\phi\frac{\sin\phi}{r} \\ 
 &\Downarrow \\
    u_{xx} = (u_x)_r r_x +(u_x)_\phi \phi_x+(u_x)_\theta \theta_x &= 
  {\tiny \left( u_{rr} \sin\phi\cos\theta +u_{\phi r} \frac{\cos\phi\cos\theta}{r} -u_\phi\frac{\cos\phi\cos\theta}{r^2}
    -u_{\theta r} \frac{\sin\theta}{r\sin\phi} +u_\theta\frac{\sin\theta}{r^2\sin\phi} \right) 
    \sin\phi\cos\theta} \\
  { \tiny +\left( u_{r\phi}\sin\phi \cos\theta \right. }&{\tiny\, \left. +u_r\cos\phi\cos\theta +u_{\phi\phi} \frac{\cos\phi\cos\theta}{r} -u_{\phi} \frac{\sin\phi\cos\theta}{r} 
    -u_{\theta\phi} \frac{\sin\theta}{r\sin\phi} +u_\theta \frac{\sin\theta\cot\phi}{r\sin\phi}
  \right)\frac{\cos\phi \cos\theta}{r}} \\
   {\tiny -\left( u_{r\theta}\sin\phi\cos\theta \right. }&{\tiny \, \left. -u_r \sin\phi\sin\theta +u_{\phi\theta} \frac{\cos\phi\cos\theta}{r} 
   -u_\phi \frac{\cos\phi\sin\theta}{r} -u_{\theta\theta}\frac{\sin\theta}{r\sin\phi} -u_\theta \frac{\cos\theta}{r\sin\phi} \right) 
   \frac{\sin\theta}{r\sin\phi} }
\end{align*}$$

---

$$\scriptsize \begin{align*}
     u_{yy} = (u_y)_r r_y +(u_y)_\phi \phi_y+(u_y)_\theta \theta_y &= 
  {\tiny \left( u_{rr} \sin\phi\sin\theta +u_{\phi r} \frac{\cos\phi\sin\theta}{r}  -u_\phi\frac{\cos\phi\sin\theta}{r^2}
    +u_{\theta r} \frac{\cos\theta}{r\sin\phi} -u_\theta\frac{\cos\theta}{r^2\sin\phi} \right) 
    \sin\phi\sin\theta }\\
  {\tiny+\left( u_{r\phi}\sin\phi \sin\theta \right.} &{\tiny\, \left. +u_r\cos\phi\sin\theta +u_{\phi\phi} \frac{\cos\phi\sin\theta}{r} -u_{\phi} \frac{\sin\phi\sin\theta}{r} 
    +u_{\theta\phi} \frac{\cos\theta}{r\sin\phi} -u_\theta \frac{\cos\theta\cot\phi}{r\sin\phi}
  \right)\frac{\cos\phi \sin\theta}{r}} \\
  {\tiny+\left( u_{r\theta}\sin\phi\sin\theta \right.} &{\tiny \, \left.+u_r \sin\phi\cos\theta +u_{\phi\theta} \frac{\cos\phi\sin\theta}{r} 
   +u_\phi \frac{\cos\phi\cos\theta}{r} +u_{\theta\theta}\frac{\cos\theta}{r\sin\phi} -u_\theta \frac{\sin\theta}{r\sin\phi} \right) 
   \frac{\cos\theta}{r\sin\phi} }\\
    u_{zz} = (u_z)_r r_z +(u_z)_\phi \phi_z+(u_z)_\theta \theta_z 
    &={\tiny \left( u_{rr}\cos\phi -u_{\phi r}\frac{\sin\phi}{r} +u_\phi\frac{\sin\phi}{r^2} \right) \cos\phi} 
    {\tiny +\left( -u_{r\phi}\cos\phi \right. +}{\tiny\, \left. u_{r}\sin\phi +u_{\phi\phi}\frac{\sin\phi}{r} +u_\phi\frac{\cos\phi}{r} \right) \frac{\sin\phi}{r}}\\ 
    &\Downarrow \\
    \color{red}{\nabla^2 u =u_{rr} +\frac{2}{r} u_r }&\color{red}{+\frac{1}{r^2}u_{\phi\phi} +\frac{\cot\phi}{r^2} u_{\phi} +\frac{1}{r^2\sin^2\phi}u_{\theta\theta}} \\
     \color{red}{= \frac{1}{r^2}\left(  r^2 u_r \right)_r }& \color{red}{+\frac{1}{r^2 \sin\phi} \left( \sin\phi\, u_\phi \right)_\phi +\frac{1}{r^2\sin^2\phi}u_{\theta\theta}}
\end{align*}$$

---

**NOTE**

* <font color=blue>The Laplacian in cartesian coordinates is the only one with constant coefficients</font>. $~$This is one reason why problems in other coordinate systems are harder to solve. <font color=blue>It is still possible to use the separation of variables for these equations with variable coefficients; $~$it's just that some of the resulting ordinary differential equations have variables coefficients</font>

. . .

* We arrive at a lot of fairly complicated equations, such as Bessel's equation, Legendre equation, and other so-called classical equations of physics. To solve these equations, $~$we must resort to infinite-series solutions and, in particular, the method of Frobenious

---

**Example** $\text{ }$ What is the wave equation $\,u_{tt}=c^2\nabla^2 u\,$ in polar coordinates if you know that the solution $u$ depends only on $r$ and $t$

---

**Example** $~$ What is Laplace's equation in spherical coordinates if the solution $u$ depends only on $r$? $~$Can you find the solutions of this equation? These are the spherically symmetric potentials in three dimensions

### Lesson 32. $~$General Nature of Boundary-Value Problems 

* <font color=blue>Many important problems whose outcomes do not change with time are described by elliptic boundary-value problems</font>. There are two common situations in physical problems that give rise to PDEs that don't involve time; $~$they are:

  <font color=blue>1. $\;$Steady-state problems</font>

  <font color=blue>2. $\;$Problems where we factor out the time component in the solution</font>

. . .

* When studying boundary-value problems (BVPs), $~$ there are three types of BCs that are most common; $~$ we discuss these three types now

---

#### Dirichlet Problems

<font color=blue>Here, the PDE holds over a given region of space, and the solution is specified on the boundary of the region</font>. An example would be to find the steady-state temperature inside a circle with the temperature given on the boundary

$$ u_{rr} +\frac{1}{r}u_r + \frac{1}{r^2} u_{\theta\theta}=0, $$
$$\;\; u(1,\theta) = \sin\theta, \;\;\;0 < r < 1,\;\;\; 0 \leq \theta < 2\pi$$

<center><img src="figures/pde03_figure05.jpg" alt="Interior Dirichlet Problem" width="500"/></center>

---

Another example would be an exterior Dirichlet problem in which we are looking for the solution of Laplace's equation outside the unit circle, and the boudary condition is given on the circle

$~$

<center><img src="figures/pde03_figure06.jpg" alt="Exterior Dirichlet Problem" width="500"/></center>

---

#### Neumann Problems

Here, $~$<font color=blue>the PDE holds in some region of space, $~$but now the outward normal derivative $\frac{\partial u}{\partial n}$ (which is proportional to the inward flux) is specified on the boundary</font>. $~$For example, $~$suppose the inward flow of heat varies around the circle according to

$$ \frac{\partial u}{\partial r}=\sin\theta$$

The steady-state temperature inside the circle would then be given by the solution of the BVP

$$ \nabla^2 u = 0, \;\;\;\; 0 < r < 1$$

$$ \frac{\partial u}{\partial r} =\sin\theta, \;\;\;\; r=1, \;\; 0 \leq \theta < 2\pi$$

---

Here, $~$we can see that the flux of heat across the boundary is inward for $0 \leq \theta \leq \pi$ and outward for $\pi \leq \theta < 2\pi$

$~$

<center><img src="figures/pde03_figure07.jpg" alt="flow of heat for the Neumann problem" width="500"/></center>

---

However, $~$since the total flux

$$ \int_0^{2\pi} \frac{\partial u}{\partial r}\, d\theta\;=\int_0^{2\pi} \sin\theta \,d\theta = 0$$

(a condition that must be true for Neumann problems), $~$we can say that the temperature at each point inside circle does not change with respect to time. $~$In other words, $~$<font color=blue>Neumann problems make sense only if the net gain in heat across the boundary is zero</font>

---

The Neumann problem is somewhat different from other boundary conditions, <font color=red>in that solutions are not unique</font>. In other words, the above Neumann problem has an infinite number of solutions $u(r,\theta)$. <font color=blue>Once we have one solution, we can get the others just by adding a constant.</font> For example, one solution to our Neumann problem is

$$ u(r,\theta)=r\sin\theta$$

and it is obvious that if we add a constant to this solution, another one is obtained. For this reason, <font color=blue>if we want to find one solution to the Neumann problem, $~$we must have some additional information (like knowing the solution at one point)</font>

---

#### Robin Problems

These problems correspond to the PDEs being given in some region of space, $~$<font color=blue>but now the condition on the boundary is a mixture of the first two kinds</font>

$$ \frac{\partial u}{\partial n} = -h(u -g)$$

where $h$ is a constant and $g$ is a given function that can vary over the boundary. $~$This BC says the inward flux across the boundary is proportional to the difference between the boundary value of $u$ and specified environment value $g$ 

---

In heat transfer, this, of course, is just Newton's law of cooling.
The constant $h$ is a physical parameter that measures the amount of flux across the boundary per difference between $u$ and $g$. $~$If $h$ is large, and so the solution looks very much like the solution of the Dirichlet problem $u=g$. $~$On the order hand, $~$if $h=0$, then the BC is reduced to the insulated BC

$$ \frac{\partial u}{\partial r}=0$$

---

**Example** $\text{ }$ Does the following Neumann have a solution inside the circle?

$$ \nabla^2 u = 0, \;\;\;\; 0 < r < 1$$

$$ \frac{\partial u}{\partial r} =\sin^2\theta, \;\;\;\; r=1, \;\; 0 \leq \theta < 2\pi$$

---

**Example** $\text{ }$ For different values of $h$, $~$imagine the solution $u(r,\theta)\,$ to

$$ \nabla^2 u = 0, \;\;\;\; 0 < r < 1$$

$$ \frac{\partial u}{\partial r} +h(u -\sin\theta)=0, \;\;\;\; r=1, \;\; 0 \leq \theta < 2\pi$$


### Lesson 33. Interior Dirichlet Problem for a Circle

This lesson presents a number of new ideas to solve the interior Dirichlet problem for the circle

$$ \color{red}{u_{rr} +\frac{1}{r}u_r + \frac{1}{r^2} u_{\theta\theta}=0, \;\;\;0 < r < 1}$$

$$ \color{red}{u(1,\theta) = g(\theta), \;\;\; 0 \leq \theta < 2\pi}$$

The method of separation of variables will be the usual procedure

$$\scriptsize\begin{align*}
 u_{rr} +\frac{1}{r}u_r &+\frac{1}{r^2}u_{\theta\theta}= 0 \\ 
  u(1,\theta) &= g(\theta) \\ 
 &\Downarrow u(r,\theta)=R(r)\Theta(\theta)\\ 
\end{align*}$$

---

$$\scriptsize\begin{align*}
 -\frac{r^2R'' +rR'}{R} &= \frac{\;\Theta''}{\Theta} =-\lambda  \leq 0 \\ 
 &\Downarrow \\
  \Theta'' +\lambda \Theta =0 \;\; \xrightarrow[]{\;\;\Theta(0)=\Theta(2\pi),\;\Theta'(0)=\Theta'(2\pi)\;\;} 
    &\;\;\Theta_n(\theta)=a_n \cos n\theta +b_n \sin n\theta, \;\; \lambda_n =n^2, \;\; n=0,1,2,\cdots \\
 &\Downarrow \\
  r^2R_0'' +rR_0'=0\; &\xrightarrow[]{\;\;R_0(0) \,<\,\infty \;\;} \;\; R_0(r)=1 \\ 
  r^2R_n''+rR_n' -n^2 R_n=0,\;\;n =1,2,\cdots\; &\xrightarrow[]{\;\;R_n(0) \,<\,\infty \;\;} \;\;R_n(r)= r^n \\ 
 &\Downarrow \\
 \color{red}{u(r,\theta) =\frac{a_0}{2} +\sum_{n=1}^\infty }&\color{red}{ r^n \left( a_n \cos n\theta +b_n \sin n\theta \right)} \\
 a_n = \frac{1}{\pi} \int_0^{2\pi} &g(\theta) \cos n\theta \,d\theta \\
 b_n = \frac{1}{\pi} \int_0^{2\pi} &g(\theta) \sin n\theta \,d\theta
\end{align*}$$

---

$\textbf{1.}~$ The solution can be interpreted as expanding the boundary function $g(\theta)$ as a Fourier series

$$ g(\theta)=\frac{a_0}{2} +\sum_{n=1}^\infty \left(a_n \cos n\theta +b_n \sin n\theta \right)$$

   and solve the problem for $\cos n\theta$ and $\sin n\theta$ in the series. $~$Since each of these terms will give rise to solutions $r^n\cos n\theta$ and $r^n \sin n\theta$, $~$we can then say (by superposition) that

$$ u(r,\theta)=\frac{a_0}{2} +\sum_{n=1}^\infty \color{red}{r^n} \left(a_n \cos n\theta +b_n \sin n\theta \right)$$

---

$\textbf{2.}~$ Note that the constant term $\displaystyle\frac{a_0}{2}$ in the solution represents the average of $g(\theta)$

$$ \frac{a_0}{2} = \frac{1}{2\pi} \int_0^{2\pi} g(\theta)\,d\theta$$

. . .

$\textbf{3.}~$ If  the radius of the circle was arbitrary (say $R$), $~$then the solution would be

$$ u(r,\theta)=\frac{a_0}{2} +\sum_{n=1}^\infty \left(\frac{r}{R}\right)^n \left(a_n \cos n\theta +b_n \sin n\theta \right)$$

This completes our discussion of the separation of variables solution. $~$We now go to the interesting Poisson integral formula

---

**Example**

The solution of

$$ \;\;\;\;\;\;\;\nabla^2 u = 0, \;\;\;0 < r < 1$$

$$\,\begin{align*}
 u(1, \theta)&=1 + \sin\theta +\frac{1}{2}\sin3\theta +\cos 4\theta \\ 
\end{align*}$$

would be

$$\,\begin{align*}
 u(r, \theta)&=1 + r\sin\theta +\frac{r^3}{2}\sin3\theta +r^4\cos 4\theta \\ 
\end{align*}$$

---

#### Poisson Integral Formula

We start with the separation of varaiables solution

$$ u(r,\theta)=\frac{a_0}{2} +\sum_{n=1}^\infty \left(\frac{r}{R}\right)^n \left(a_n \cos n\theta +b_n \sin n\theta \right)$$

and substitute the coefficients $a_n$ and $b_n$. $~$After a few manipulations, $~$we have

$$\scriptsize\begin{align*}
 u(r,\theta) &= \frac{1}{2\pi} \int_0^{2\pi} g(\alpha)\,d\alpha +\frac{1}{\pi} 
  \sum_{n=1}^\infty \left(\frac{r}{R} \right)^n \int_0^{2\pi} g(\alpha) \left( \cos n\alpha\cos n\theta+\sin n\alpha \sin n\theta \right)\,d\alpha \\ 
 &= \frac{1}{2\pi} \int_0^{2\pi}  \left\{  1 +2\sum_{n=1}^\infty \left(\frac{r}{R} \right)^n \cos n(\theta -\alpha) \right\}\,g(\alpha)\,d\alpha \\ 
\end{align*}$$

---

$$\scriptsize\begin{align*}
 &= \frac{1}{2\pi} \int_0^{2\pi}  \left\{  1 +\sum_{n=1}^\infty \left(\frac{r}{R} \right)^n \left[e^{in(\theta -\alpha)} +e^{-in(\theta -\alpha)}  \right] \right\}\,g(\alpha)\,d\alpha \\ 
 &= \frac{1}{2\pi} \int_0^{2\pi}  \left\{  1 +\frac{re^{i(\theta -\alpha)}}{R -re^{i(\theta -\alpha)}} 
 +\frac{re^{-i(\theta -\alpha)}}{R -re^{-i(\theta -\alpha)}} \right\}\,g(\alpha)\,d\alpha \\ 
 &= \color{red}{\frac{1}{2\pi} \int_0^{2\pi}  \left\{ \frac{R^2 -r^2}{R^2 +r^2 -2rR\cos(\theta -\alpha)} \right\}\,g(\alpha)\,d\alpha} 
\end{align*}$$

This last equation is what we were looking for; $~$ it's <font color=blue>the Poisson Integral Formula</font>

---

$\textbf{1.}~$ We can interpret the Poisson integral solution as finding the potential $u$ at $(r,\theta)$ as a weighted average of the boundary potentials $g(\theta)$ weighted by the Poisson kernel

$$ \text{Poisson kernel}=\frac{R^2 -r^2}{R^2 +r^2 -2rR\cos(\theta -\alpha)}$$

<center><img src="figures/pde03_figure08.jpg" alt="Poisson Kernel" width="500"/></center>

<font size="5px">For boundary values $g(\alpha)$ close to $(r,\theta)$, $~$the Poisson kernel gets larger, $~$since the denominator of the Poisson kernel is the square of the distance from $(r,\theta)$ to $(R,\alpha)$</font>

---

$\textbf{2.}~$ If we evaluate the potential at the center of the circle by the Poisson integral, $~$we find

$$ u(0,0) = \frac{1}{2\pi} \int_0^{2\pi} g(\theta) \,d\theta$$

In other words, $~$the potential at the center of the circle is the average of the boundary potential

### Lesson 34. The Dirichlet Problem in an Annulus and in an Exterior


The Dirichlet problem between two circles (annulus) is

$$ \color{red}{u_{rr} +\frac{1}{r}u_r + \frac{1}{r^2} u_{\theta\theta}=0, \;\;R_1 < r < R_2}$$
$$\;\; \color{red}{\begin{align*} u(R_1,\theta) &= g_1(\theta) \\ u(R_2,\theta) &= g_2(\theta) \end{align*}, \;\;\; 0 \leq \theta < 2\pi}$$

<center><img src="figures/pde03_figure09.jpg" alt="An annulus" width="500"/></center>

---

We begin by looking for solutions of the form

$$ u(r,\theta)=R(r)\Theta(\theta)$$

Substituting this into Laplace's equation, $~$we get the two following ODEs in $R(r)$ and $\Theta(\theta)$:

$$\begin{align*}
 &r^2 R'' +rR' -\lambda R = 0 \;\;\;\;(\text{Euler's equation}) \\ 
 &\Theta'' +\lambda \Theta = 0 
\end{align*}$$

Note that in the two equations, $~$we required the separation constant $\lambda$ to be greater than, or equal to zero, or else the solution for $\Theta(\theta)$ would not be periodic

---

Solving these two ODEs, $~$we now have

$$\begin{align*}
 \lambda = 0 \;\; 
 &\begin{cases}
 \Theta(\theta)= \alpha + \beta\theta \\
 R(r) = \gamma + \delta\ln r 
 \end{cases} \\ 
 \lambda > 0 \;\;
 &\begin{cases}
 \Theta(\theta)=  a\cos\sqrt{\lambda}\theta +b\sin \sqrt{\lambda}\theta\\ 
 R(r) = cr^{\sqrt{\lambda}} +dr^{-\sqrt{\lambda}}   
 \end{cases} 
\end{align*}$$

and using the requirement that $\Theta(\theta)$ must be periodic with period $2\pi$, $~$we have that $\beta=0 \text{ at } \lambda=0$ and $\lambda (>0)$ must be $n^2$, $n= 0,1,2,\cdots$

---

Hence, we arrive at the following solutions to Laplace's equation

$$\begin{align*}
 &1 \;\;\;(\text{constants}) \\ 
 &\ln r \\ 
 &r^n \cos n\theta \\ 
 &r^n \sin n\theta \\ 
 &r^{-n} \cos n\theta \\
 &r^{-n} \sin n\theta 
\end{align*}$$

---

Since any sum of these solutions is also a solution, $~$we arrive at our general solution

$$ \color{red}{u(r,\theta) = \frac{a_0}{2} +\frac{\tilde{a_0}}{2} \ln r +\sum_{n=1}^\infty \left[ \left(a_n r^n +\tilde{a_n} r^{-n}\right) \cos n\theta +
\left(b_n r^n +\tilde{b_n} r^{-n}\right) \sin n\theta \right]}$$

The only task left is to determine the constants in the sum so that $u(r,\theta)$ satisfies the BCs

$$ \begin{align*} u(R_1,\theta) &= g_1(\theta) \\ u(R_2,\theta) &= g_2(\theta) \end{align*}, \;\;\; 0 \leq \theta < 2\pi$$

---

Substituting the general solution into these BCs and integrating gives the following equations

$$\scriptsize\begin{align*}
 &\begin{cases}
  \displaystyle a_0 +\tilde{a_0} \ln R_1 =\frac{1}{\pi} \int_0^{2\pi} g_1(\alpha)\,d\alpha \\ 
  \displaystyle a_0 +\tilde{a_0} \ln R_2 =\frac{1}{\pi} \int_0^{2\pi} g_2(\alpha)\,d\alpha
 \end{cases} \;\;\;\;\;\;\;\;\;\;\;\;\text{Solve for } a_0, \tilde{a_0} \\ 
 &\begin{cases}
  \displaystyle a_n R_1^n +\tilde{a_n} R_1^{-n} =\frac{1}{\pi} \int_0^{2\pi} g_1(\alpha) \cos n\alpha \,d\alpha \\ 
  \displaystyle a_n R_2^n +\tilde{a_n} R_2^{-n} =\frac{1}{\pi} \int_0^{2\pi} g_2(\alpha) \cos n\alpha \,d\alpha
\end{cases} \;\;\;\;\text{Solve for } a_n, \tilde{a_n} \\ 
 &\begin{cases}
  \displaystyle b_n R_1^n +\tilde{b_n} R_1^{-n} =\frac{1}{\pi} \int_0^{2\pi} g_1(\alpha) \sin n\alpha \,d\alpha \\ 
  \displaystyle b_n R_2^n +\tilde{b_n} R_2^{-n} =\frac{1}{\pi} \int_0^{2\pi} g_2(\alpha) \sin n\alpha \,d\alpha
\end{cases} \;\;\;\;\;\text{Solve for } b_n, \tilde{b_n}
\end{align*}$$

---

**Example** $\text{ }$ Suppose the potential on the inside circle is zero, $~$while the outside potential is $\sin \theta$

$$ u_{rr} +\frac{1}{r}u_r + \frac{1}{r^2} u_{\theta\theta}=0, \;\;\;1 < r < 2$$

$$ \begin{align*} u(1,\theta) &= 0 \\ u(2,\theta) &= \sin\theta \end{align*}, \;\;\; 0 \leq \theta < 2\pi$$

Solving the necessary equations for $a_0, \tilde{a_0}$, $a_n, \tilde{a_n}$, $b_n$, and $\tilde{b_n}$ yields

$$ u(r,\theta)=\frac{2}{3} \left(r -\frac{1}{r} \right) \sin \theta$$

---

In this case, $~$since it's obvious that the solution is independent of $\theta$, $~$we know our solution must be of the form $a_0 +\tilde{a_0} \ln r$. $~$Using our two equations for $a_0$ and $\tilde{a_0}$, $~$we obtain

$$ u(r,\theta)=3 +\frac{2}{\ln 2} \ln r$$

The only solutions of the two dimensional Laplace equation that depend only on $r$ are constant and $\ln r$. $~$The potential $\,\ln r\,$ is very important and is called the logarithmic potential

---

**Example** $\text{ }$ Another interesting problem is

$$ u_{rr} +\frac{1}{r}u_r + \frac{1}{r^2} u_{\theta\theta}=0, \;\;\;1 < r < 2$$

$$ \begin{align*} u(1,\theta) &= \sin\theta \\ u(2,\theta) &= \sin\theta \end{align*}, \;\;\; 0 \leq \theta < 2\pi$$

A quick check of the coefficients reveals that they are all zero except for $b_1$ and $\tilde{b_1}$. Solving for $b_1$ and $\tilde{b_1}$ gives the solution

$$ u(r,\theta)=\left(\frac{r}{3} +\frac{2}{3r}\right) \sin\theta$$

---

#### Exterior Dirichlet Problem


The exterior Dirichlet problem

$$ u_{rr} +\frac{1}{r}u_r + \frac{1}{r^2} u_{\theta\theta}=0, \;\;\;\color{red}{R_1 < r < \infty}$$

$$ u(R_1,\theta)=g(\theta), \;\;\; 0 \leq \theta < 2\pi$$

is solved exactly like the interior Dirichlet problem except that now we throw out the solutions that are unbounded as $r$ goes to infinity

---

Hence, $~$ we left with the solution

$$ \color{red}{u(r,\theta)= \frac{a_0}{2} +\sum_{n=1}^{\infty} \left(\frac{r}{R_1}\right)^{-n}\left( \tilde{a_n} \cos n\theta +\tilde{b_n} \sin n \theta \right)}$$

where $a_0$, $\tilde{a_n}$, and $\tilde{b_n}$ are exactly as Fourier series. $~$In other words, $~$we merely expand $u(R_1,\theta)=g(\theta)\,$ as a Fourier series

$$ g(\theta)=\frac{a_0}{2} +\sum_{n=1}^\infty \left( \tilde{a_n} \cos n\theta +\tilde{b_n} \sin n\theta \right)$$

and then insert the factor $\displaystyle\left(\frac{r}{R_1}\right)^{-n}$ in each term to get the solution

---

**Example** $\text{ }$ The exterior problem 

$$ u_{rr} +\frac{1}{r}u_r + \frac{1}{r^2} u_{\theta\theta}=0, \;\;\;1 < r < \infty$$

$$ u(1,\theta)=1 +\sin\theta +\cos 3\theta, \;\;\; 0 \leq \theta < 2\pi$$

has the solution

$$ u(r,\theta)=1 +\frac{1}{r}\sin\theta +\frac{1}{r^3}\cos 3\theta, \;\;\; 0 \leq \theta < 2\pi$$

---

**Example** $\text{ }$ The exterior Neumann problem

$$ u_{rr} +\frac{1}{r}u_r + \frac{1}{r^2} u_{\theta\theta}=0, \;\;\;1 < r < \infty$$

$$ \frac{\partial u}{\partial r}(1,\theta)=g(\theta), \;\;\; 0 \leq \theta < 2\pi$$

has a solution that is the same form as the Dirichlet problem

$$ u(r,\theta)= \frac{a_0}{2} +\sum_{n=1}^{\infty} r^{-n}\left( \tilde{a_n} \cos n\theta +\tilde{b_n} \sin n \theta \right)$$

but now the coefficients $a_0$, $\tilde{a_n}$, and $\tilde{b_n}$ must satisfy the new BC.
Of course, once you have this solution, any constant plus this solution is also a solution


### Lesson 35. Laplace's Equation in Spherical Coordinates (Spherical Harmonics)

* An important problem in physics is to find the potential inside or outside a sphere when the potential is given on the boundary 

. . .

* For the interior problem, $\,$we must find the solution $u(r,\phi,\theta)$ that satisfies

  $$ \left( r^2 u_r \right)_r +\frac{1}{\sin\phi} \left( \sin\phi\, u_\phi \right)_\phi +\frac{1}{\sin^2\phi} u_{\theta\theta} = 0 $$

  <font color=blue> $$ u(1,\phi,\theta)=g(\phi,\theta), \;0\leq \theta <2\pi,\;0 \leq \phi < \pi $$ </font>

  <font size="5px">Note that this spherical Laplacian is written in a different form than those we've seen before. This form is slightly more compact and easier to use</font>

---

Quite often $g(\phi,\theta)$ has a specific form, so that it isn't necessary to solve the problem in its most general form. Two important special cases are considered in this Lesson. <font color=blue>One is the case when $g(\phi,\theta)$ is constant, and the other is when it depends only on the angle $\phi$ (the angle from the north pole)</font>

<center><img src="figures/pde03_figure10.jpg" alt="spherical coordinate" width="600"/></center>

---

#### Special Case 1 $\text{ }$ $-\;\;\color{red}{g(\phi,\theta) = \text{constant}}$

In this case, $~$it is clear that the solution is independent of $\phi$ and $\theta$, $\,$and so Laplace's equation reduces to the ODE

$$ \left( r^2 u_r \right)_r = 0 $$

This is a simple ODE that the student can easily solve; $~$the general solution is 

$$ u(r)=\frac{a}{r} +b $$

In other words, $\,$constant and $\,\displaystyle\frac{a}{r}\,$ are the only potential that depend only on the radial distance from the origin. The potential $\,\displaystyle\frac{1}{r}\,$ is very important in physics and is called the Newtonian potential

---

**Example** $\text{ }$ (Potential interior to a sphere)

$$ \nabla^2 u = 0, \;\;\; 0 < r < 1 $$

$$ u(1,\phi,\theta) = 3 $$

Here solution must be $u(r,\phi,\theta) = 3$ in order to be bounded

---

**Example** $\text{ }$ (Potential between two spheres each at constant potential)

Suppose we want to find the steady-state temperature between two spheres held at different temperatures

$$ \nabla^2 u = 0, \;\;\; R_1 < r < R_2 $$

$$\begin{align*}
 u(R_1,\phi,\theta) &= A \\ 
 u(R_2,\phi,\theta) &= B 
\end{align*}$$

Since we know the potential has the general solution

$$ u(r)=\frac{a}{r} +b $$

---

we substitute it in the BCs and solve for $a$ and $b$; $~$doing this gives

$$ u(r)= (A -B) \frac{R_1 R_2}{R_2 -R_1} \frac{1}{r} + \frac{R_2 B -R_1 A}{R_2 -R_1} $$

$~$

<center><img src="figures/pde03_figure11.jpg" alt="potential between two concentric spheres" width="900"/></center>

---

#### Special Case 2 $\text{ }$ $-\;\;\color{red}{g(\phi,\theta) \text{ depends only on } \phi}$

Here, the Dirichlet problem takes the form

$$ \left( r^2 u_r \right)_r +\frac{1}{\sin\phi} \left( \sin\phi\, u_\phi \right)_\phi = 0, \;\;\; 0 < r < 1 $$

$$ u(1,\phi)=g(\phi),\;\;\; 0 \leq \phi \leq \pi $$

---

Using separation of variables, $~$we look for solutions of the form

$$ u(r,\phi)=R(r)\Phi(\phi) $$

and arrive at the two ODEs

$$ \begin{align*}
 &\left(\sin\phi\, \Phi' \right)' +\lambda \sin\phi \Phi= 0\;\;\;\text{Legendre's equation}\\ 
 &r^2R'' +2rR' -\lambda R = 0 \;\;\; \text{Euler's equation}
\end{align*} $$

Legendre's equation isn't easy; $~$the general strategy in solving this equation is to make the substitution

<font color=blue>$$x=\cos\phi$$</font>

Making this change of variable gives rise to the new Legendre's equation

---

$$\scriptsize \begin{align*}
 \left(\sin\phi\, \Phi' \right)' &+\lambda \sin\phi \Phi= 0\\ 
 & \Downarrow \;\;x=\cos\phi, \;\;
 \Phi'=\frac{d\Phi}{dx} \frac{dx}{d\phi}=-\sin\phi\frac{d\Phi}{dx} \\
 \left(\sin\phi\, \Phi' \right)'&=-\frac{d}{dx}\left(\sin^2\phi \frac{d\Phi}{dx} \right) \frac{dx}{d\phi}
  =\left(\sin^2\phi \frac{d^2\Phi}{dx^2} +2\sin\phi\cos\phi \frac{d\phi}{dx}\frac{d\Phi}{dx} \right)\sin\phi \\
  &=\left[ (1 -x^2) \frac{d^2\Phi}{dx^2} -2x\frac{d\Phi}{dx} \right] \sin\phi \\
 &\Downarrow \\
 \color{red}{(1 -x^2) \frac{d^2\Phi}{dx^2}} &\color{red}{-2x\frac{d\Phi}{dx} +\lambda \Phi = 0, \;\;\; -1 \leq x \leq 1} \\
 &\Downarrow \\
 \frac{d}{dx} \left[ (1 -x^2) \frac{d\Phi}{dx} \right] &+\lambda \Phi = 0
\end{align*}$$

---

* One of the difficulties in this equation is that 

  > <font color="blue">the coefficient $\,(1-x^2)$ of $\displaystyle \,\frac{d^2\Phi}{dx^2}$ is zero at the ends of the domain $-1 \leq x \leq 1$ </font>
  
  Equations like this are called singular differential equations. We arrive at a very interesting conclusion

---  

* <font color=red>The only bounded solutions of Legendre's equation occur when $\lambda=n(n +1)$, $\;n=0,1,2,\cdots$ and these solutions are Legendre polynomials $P_n(x)$</font>

  $$\begin{align*}
    &P_0(x) = 1 \\ 
    &P_1(x) = x \\ 
    &P_2(x) = \frac{1}{2}(3x^2 -1) \\ 
    &P_3(x) = \frac{1}{2}(5x^3 -3x) \\
    &\;\;\;\;\;\;\;\; \vdots \\
    &P_n(x) = \frac{1}{2^n n!} \frac{d^n}{dx^n} \left[ (x^2 -1)^n \right]
  \end{align*}$$

---

The graphs of a few Legendre polynomials are shown in

$~$

<center><img src="figures/pde03_figure12.jpg" alt="Legendre polynomials" width="900"/></center>

---

We now solve Euler's equation by substituting $\lambda = n(n+1)$ and $R(r)=r^\alpha$ in the equation and solving for $\alpha$. $~$Doing this,$~$ we get two values


$$\alpha = \begin{cases}
   \;\;\;\;\;\;\; n \\ 
 -(n +1) 
\end{cases}$$

and, hence, Euler's equation has the general solution

$$R_n(r)= a_n r^n + b_n r^{-(n +1)} \;\;\xrightarrow[]{\text{ bounded solution }}\;\;a_n r^n$$

---

The final step is to form the sum

$$ \color{red}{u(r,\phi) = \sum_{n=0}^\infty a_n r^n P_n(\cos\phi)}\;\;\;$$ {#eq-ls-phi} 

in such a way that it agrees with the BC $\,u(1,\phi)=g(\phi)$. $~$ Substituting the above solution into the BC gives

$$ g(\phi) = \sum_{n=0}^\infty a_n P_n(\cos\phi)$$

---

If we multiply each side of this equation by $P_m(\cos\phi)\sin\phi$ and integrate $\phi$ from $0$ to $\pi$, $~$we get

$$\begin{align*}
 \int_0^\pi g(\phi) P_m(\cos\phi)\,\sin\phi \,d\phi &= 
   \sum_{n=0}^\infty a_n \int_0^{\pi} P_n(\cos\phi) P_m(\cos\phi)\,\sin\phi \, d\phi \\
 &= \sum_{n=0}^\infty a_n \int_{-1}^1 P_n(x) P_m(x) \,dx \\ 
 &=
 \begin{cases}
  \;\;\;\;\, 0  & n \neq m \\ 
  \displaystyle \frac{2}{2m +1}\, a_m & n = m 
 \end{cases} \\ 
 &\Downarrow \\ 
 a_n &=\frac{2n +1}{2} \int_0^{\pi} g(\phi) P_n(\cos\phi)\, \sin \phi \,d\phi
\end{align*}$$

---

**Example** $\text{ }$ Suppose the temperature on the surface of the sphere is given by

$$ g(\phi) = 1 -\cos 2\phi, \;\;\;\; 0 \leq \phi \leq \pi $$

and suppose we would like to find the temperature inside the sphere. In this problem, $~$the temperature is constant on circles of constant latitude. To find $u$, $~$we must solve

$$ \left( r^2 u_r \right)_r +\frac{1}{\sin\phi} \left( \sin\phi\, u_\phi \right)_\phi = 0, \;\;\; 0 < r < 1 $$

$$u(1,\phi)=1 -\cos 2\phi,\;\;\; 0 \leq \phi \leq \pi $$

---

Our goal now is to expand $g(\phi)$ as a series of Legendre polynomials;

$$\begin{align*}
 1 -\cos 2\phi &= 1 - \left( 2\cos^2\phi -1 \right) \\ 
 &= \frac{4}{3} - \frac{4}{3}\left[ \frac{1}{2} (3\cos^2\phi -1) \right] \\ 
 &= \frac{4}{3} P_0(\cos\phi) -\frac{4}{3}P_2(\cos\phi)\\
 &\Downarrow \\
 a_0 = \frac{4}{3},\;\; a_2&=-\frac{4}{3},\;\;a_1=a_3=a_4=a_5=\cdots =0
\end{align*}$$

Hence, the solution to the problem is

$$\begin{align*}
 u(r,\phi) &= \frac{4}{3} P_0(\cos\phi) -\frac{4}{3} r^2 P_2(\cos\phi)
 = \frac{4}{3} - \frac{2}{3} r^2 (3\cos^2\phi -1) 
\end{align*}$$

---

**NOTES** $\text{ }$ The solution of the exterior Dirichlet problem

  $$\;\;\displaystyle \left( r^2 u_r \right)_r +\frac{1}{\sin\phi} \left( \sin\phi\, u_\phi \right)_\phi = 0, \;\; 1 < r < \infty, \;\;u(1,\phi)=g(\phi),\;\;\; 0 \leq \phi \leq \pi $$

  is 
  
  $$ u(r,\phi)=\sum_{n=0}^\infty \frac{b_n}{r^{n+1}} P_n(\cos\phi)$$

  where $\;\displaystyle b_n = \frac{2n +1}{2} \int_0^\pi g(\phi) P_n(\cos\phi)\, \sin\phi \, d\phi$

  $~$

  <font size="5px">For example, $\,$ the BC $g(\phi)=3$ would yield the solution $u(r,\theta)=3/r$. $~$ Note that in this problem, the solution goes to zero, while in two dimensions, the exterior solution with constant BC was itself a constant</font>

---  

#### General Case  $\text{ }$ $-\;\;\color{red}{g(\phi,\theta)}$

We consider the boundary value problem

$$\color{red}{\begin{align*}
 u_{rr} +\frac{2}{r} u_r &+\frac{1}{r^2}u_{\phi\phi} +\frac{\cot\phi}{r^2} u_{\phi} +\frac{1}{r^2\sin^2\phi}u_{\theta\theta} = 0, \;\; r < R \\ 
 u(R,\phi,\theta) &= g(\phi,\theta)\\ 
\end{align*}}$$ {#eq-sp}

in a sphere of radius $R$

a. $~$ Solve this problem by separation of variables, 

b. $~$ Derive $K(r,\phi,\theta; R,\varphi,\vartheta)$ in the equivalent integral formula:

$$ u(r,\phi,\theta) = \int_0^{2\pi} \int_0^\pi K(r,\phi,\theta; R,\varphi,\vartheta)\, g(\varphi,\vartheta) \sin\varphi \,d\varphi \, d\vartheta$$

---

**(a)** $\text{ }$ Applying separation of variables, $~$we find that the equation has the solution of the form $R(r) \,\Phi(\phi) \,\Theta(\theta)$, $~$provided

$$ -r^2 \sin^2\phi \, \frac{R'' +\frac{2}{r}R'}{R} -\sin\phi\frac{(\sin\phi\, \Phi')'}{\Phi} = \frac{\;\Theta''}{\Theta}= -\mu < 0$$

Since $\Theta$ must be periodic of period $2\pi$, $~$we have $\color{blue}{\Theta=\cos m\theta}\;$ or $\;\color{blue}{\sin m\theta}$, $~$where $\color{blue}{\mu = m^2, \; m = 0, 1, 2,\cdots}$. $~$Then

$$\begin{align*}
 -\frac{r^2 R'' +2rR'}{R} = \frac{(\sin\phi\, \Phi')'}{\sin\phi\,\Phi} &-\frac{m^2}{\sin^2\phi} = -\lambda < 0 \\ 
 &\Downarrow \\ 
 \color{blue}{(\sin\phi\, \Phi')' +\left(\lambda \sin\phi  \color{red}{-\frac{m^2}{\sin\phi}} \right) \Phi }&\color{blue}{= 0}\\ 
 \color{blue}{r^2 R'' +2r R' -\lambda R} &\color{blue}{= 0} 
\end{align*}$$

---

* The equation for $\Phi(\phi)$ is singular at its two endpoints $\phi=0$ and $\phi=\pi$. $~$In lieu of boundary conditions, $~$we impose the condition that $\Phi$ and $\Phi'$ remain bounded at both ends. This gives an eigenvalue problem with two singular endpoints. We introduce the new variable $x=\cos\phi$ and let $\Phi(\phi)=P(\cos\phi)$. Then the equation for $\Phi(\phi)$  becomes

  $$\color{red}{\frac{d}{dx} \left[\left(1 -x^2\right) \frac{dP}{dx} \right] +\left[\lambda -\frac{m^2}{1 -x^2 } \right] P = 0}$$ {#eq-sp-1}

---  

* In the case of $\, m=0$: 

  $$\frac{d}{dx} \left[\left(1 -x^2\right) \frac{dP}{dx} \right] +\lambda P = 0$$ {#eq-sp-2}


  we obtain a function which is bounded for $-1 \leq x \leq 1$ if and only if

  $$\lambda=n(n+1), \;\;n=0,1,2,\cdots$$

  These, $\,$then, $\,$are the eigenvalues. Setting $P_n(1)=1$, $~$we obtain the eigenfunction $P_n(x)$ corresponding to the eigenvalue $\lambda_n=n(n+1)$:

  $$ P_n(x)= \sum_{k=0}^n \frac{(n +k)!}{2^k (k!)^2 (n -k)!}(x - 1)^k\;\;$$

  It is called a **Legendre polynomial**

---

* Since $P_n(x)$ is of exactly degree $n$ in $x$, $~$ any polynomial of degree $k$ can be expressed as a linear combination of $P_n(x)$ with $n=0,1,\cdots,k$. $~$Since $P_n(x)$ are orthogonal, $~$each $P_n(x)$ must therefore be orthogonal to all powers of $x$ less than $n$:

  $$ \int_{-1}^1 x^k P_n(x)\, dx=0, \;\;k=0,1,\cdots, n-1$$

  These $n$ linear conditions, $\,$together with the fact that $P_n(x)$ is of degree $n$, $~$determine $P_n(x)$ uniquely

---

* We can verify the identity

  $$ P_n(x)=\frac{1}{2^n n!}\frac{d^n}{dx^n} \left(x^2 -1\right)^n$$

  which is called the **Rodrigues formula**. $\,$It is clear from this formula that $P_n(x)$ is even in $x$ if $n$ is even, $\,$and odd if $n$ is odd

. . .  

* The Legendre polynomials can also be defined as the coefficients in a formal expansion in powers of $t$ of the **generating function**

  $$ \frac{1}{\sqrt{1 -2xt +t^2}} = \sum_{n=0}^\infty P_n(x) t^n $$

---

* We now wish to consider the equation @eq-sp-1 with a positive $m$. $\,$ For this purpose, $\,$ we first differentiate the equation @eq-sp-2 $\,m$ times with respect to $x$. $\,$This gives

  $$ \left(1 -x^2\right) \frac{d^{m+2}}{dx^{m+2}}P -2(m +1)x \frac{d^{m+1}}{dx^{m+1}}P +\left[ \lambda -m(m +1)\right] \frac{d^{m}}{dx^{m}}P=0$$

  We now introduce the new dependent variable

  $$ \color{red}{Q(x)=\left(1 -x^2\right)^{m/2} \frac{d^{m}}{dx^{m}}P(x)}$$

---  

* The above equation becomes

  $$\frac{d}{dx} \left[\left(1 -x^2\right) \frac{dQ}{dx} \right] +\left[\lambda -\frac{m^2}{1 -x^2 } \right] Q = 0\;\;$$

  Thus any solution $P(x)$ of @eq-sp-2 leads to a solution $Q(x)$ of @eq-sp-1, $\,$unless $P(x)$ is a polynomial of degree less than $m$

. . .  
  
* Since $P_n(x)$ is a polynomial of degree $n$, $~(d^m/dx^m) P_n = 0~$ for $n<m$, $\,$and we get no eigenfunction. Therefore, $\,$the eigenvalues are precisely $n(n+1)$ with $n=m, m+1, \cdots.$ $\,$The eigenfunctions

  $$ \color{red}{P_n^m(x)=\left(1 -x^2 \right)^{m/2} \frac{d^m}{dx^m} P_n(x)=\frac{1}{2^n n!} \left(1 -x^2 \right)^{m/2} \frac{d^{m +n}}{dx^{m +n}} \left(x^2 -1 \right)^n}$$

  are called the **associated Legendre functions**. $\,P_n^m(x)$ corresponds to the eigenvalue $n(n +1)$, $\,$and $n \geq m$ 

---

* In Fourier expressions, $\,$it is useful to know the integrals of $\left[P_n^m(x)\right]^2$. $\,$It follows from the Rodrigues formula and $\,n\,$ integrations by parts that

  $$\tiny \begin{align*}
    \int_0^\pi \left[ P_n(\cos\phi)\right]^2 \,\sin\phi  \,d\phi &= \int_{-1}^1 \left[P_n(x) \right]^2 \,dx\\ 
    &= \frac{1}{2^{2n} n!^2} \int_{-1}^1 \left[ \frac{d^n}{dx^n} \left(1- x^2 \right)^n\right]^2 \, dx\\ 
    &= \frac{1}{2^{2n} n!^2} \left[ \underbrace{\left.\frac{d^{n-1}}{dx^{n-1}} \left(1- x^2 \right)^n
    \frac{d^{n}}{dx^{n}} \left(1- x^2 \right)^n \right|_{-1}^{1}}_{=0} 
    -\int_{-1}^1 \frac{d^{n-1}}{dx^{n-1}} \left(1- x^2 \right)^n
    \frac{d^{n+1}}{dx^{n+1}} \left(1- x^2 \right)^n \,dx\right]\\ 
    &\;\vdots \\ 
    &=\frac{(-1)^n}{2^{2n} n!^2} \int_{-1}^1 \left(1- x^2 \right)^n
    \underbrace{\frac{d^{2n}}{dx^{2n}} \left(1- x^2 \right)^n}_{(-1)^n (2n)!} \,dx \\
    &=\frac{(2n)!}{2^{2n} n!^2} \int_{-1}^1 \left(1- x^2 \right)^n \,dx = \frac{(2n)!}{2^{2n} n!^2} 2^{2n +1} \frac{n!^2}{(2n+1)!}=\frac{2}{2n +1}
  \end{align*}$$

---

* Similarly,

  $$\tiny \begin{align*}
     \color{blue}{\int_0^\pi \left[ P_n^m(\cos\phi)\right]^2 \,\sin\phi  \,d\phi} &= \int_{-1}^1 \left[P_n^m(x) \right]^2 \,dx 
     = \int_{-1}^1 \left[ \left(1 -x^2 \right)^{m/2} \frac{d^m}{dx^m} P_n(x) \right]^2 \, dx\\ 
    &= \underbrace{\left. \frac{d^{m-1}}{dx^{m-1}} P_n(x)
    \left\{ \left(1- x^2 \right)^m  \frac{d^m}{dx^m} P_n(x) \right\} \right|_{-1}^{\phantom{-}1}}_{=0} 
    -\int_{-1}^1 \frac{d^{m-1}}{dx^{m-1}} P_n(x)
    \frac{d}{dx} \left\{\left(1- x^2 \right)^m  \frac{d^m}{dx^m} P_n(x)  \right\} \,dx \\ 
    &\;\Downarrow \;\;\left(1- x^2 \right)^m = (-1)^m x^{2m}+\cdots, \;\;\frac{d^m}{dx^m} P_n(x)=c_n \frac{n!}{(n -m)!}x^{n -m}+\cdots\\ 
    &= (-1)^m \int_{-1}^1 P_n(x)
    \underbrace{\frac{d^m}{dx^m} \left\{\left(1- x^2 \right)^m  \frac{d^m}{dx^m} P_n(x) \right\}}_{(-1)^m \,c_n\, \frac{n!}{(n-m)!\;} \,\frac{(n +m)!\;}{n!} \,x^n +\,\cdots} \,dx \\
    &=\frac{(n+m)!}{(n-m)!} \int_{-1}^1 P_n(x) c_n x^n \,dx \\
    &=\frac{(n+m)!}{(n-m)!} \int_{-1}^1 \left[ P_n(x) \right ]^2 \,dx \\
    &=\color{blue}{\frac{2}{2n +1}\frac{(n+m)!}{(n-m)!}}
   \end{align*}$$

  in which $c_n$ is the coefficient of $x^n$ in $P_n(x)$

---

* Putting $\lambda=n(n+1)$ in the equation for $R(r)$, $~$ we obtain the two solutions $\color{blue}{r^n}$ and $r^{-(n +1)}$. $~$ Only the first of these is bounded at $r=0$

. . .

* The method of separation of variables thus gives the harmonic functions

  <font color="red">$$\begin{align*}
    &r^n P_n^m(\cos\phi) \cos m\theta\\ 
    &r^n P_n^m(\cos\phi) \sin m\theta 
   \end{align*}$$</font>

---

* We note that $P_n^m(\cos\phi)$ is $\sin^m\phi$ times a polynomial of degree $n -m\,$ in $\cos\phi\,$ which is even or odd according as $n -m\,$ is even or odd

. . .

* Since $r\cos\phi=z$, $~$it follows that $r^{n-m}$ times this polynomial is a polynomial in $r^2$ and $z$, and hence in $x$, $y$, and $z$
  
. . .

* Also, $r\sin\phi=\sqrt{x^2 +y^2}$. Thus $r^m\sin^m\phi \cos m\theta$ and $r^m\sin^m\phi \sin m\theta$ are the polynomial solutions 
in $x$ and $y$ obtained by separating the two-dimensional Laplace's equation in polar coordinates

. . .

* We see then that the functions $r^n P_n^m(\cos\phi) \cos m\theta$ and $r^n P_n^m(\cos\phi) \sin m\theta$ are homogeneous polynomials of degree $n$ in $x$, $y$, and $z$. They are of degree $n -m$ in $z$. These polynomials are called **spherical harmonics**

---

* The formal solution of the problem is then

  $$ \color{red}{u(r,\phi,\theta) = \sum_{n=0}^\infty \left( \frac{r}{R} \right)^n \left[ \frac{1}{2} a_{n0} P_n(\cos\phi) +\sum_{m=1}^n \left(a_{nm} \cos m\theta +b_{nm} \sin m\theta \right) P_n^m(\cos\phi) \right]} $$

  where

  $$\begin{align*}
    a_{nm} &= \frac{(2n +1)}{2\pi}\frac{(n -m)!}{(n +m)!} \int_{0}^{2\pi} \int_{0}^\pi g(\phi,\theta) \,P_n^m(\cos\phi) \,\cos m\theta \,\sin\phi \,d\phi \,d\theta \\ 
    b_{nm} &= \frac{(2n +1)}{2\pi}\frac{(n -m)!}{(n +m)!} \int_{0}^{2\pi} \int_{0}^\pi g(\phi,\theta) \,P_n^m(\cos\phi) \,\sin m\theta \,\sin\phi \,d\phi \,d\theta
   \end{align*} $$

  are the $n$-th Fourier coefficients of $g(\phi,\theta)=u(R,\phi,\theta)$

---

**(b)** $\text{ }$ We can write this solution as

  $$ u(r,\phi,\theta) = \int_0^{2\pi} \int_0^\pi K(r,\phi,\theta; R,\varphi,\vartheta)\, g(\varphi,\vartheta) \sin\varphi \,d\varphi \, d\vartheta $$

  where

  $$ \tiny K(r,\phi,\theta; R,\varphi,\vartheta)=\sum_{n=0}^\infty \left( \frac{r}{R} \right)^n \underbrace{\left[ \frac{2n +1}{4\pi} P_n(\cos\phi) P_n(\cos\varphi) +\sum_{m=1}^n \frac{(2n +1)}{2\pi}\frac{(n -m)!}{(n +m)!} P_n^m(\cos\phi) P_n^m(\cos\varphi) \cos m(\theta -\vartheta) \right]}_{K_n(\phi,\,\theta; \,\varphi,\,\vartheta)}$$ {#eq-sp-3}

. . .

* For a fixed $n$, 

  $$\begin{align*}
     \int_{0}^{2\pi} \int_{0}^\pi & \,K_n(\phi,\theta;\varphi,\vartheta)\, r^l \,P_l^m(\cos\varphi) \,(a\cos m\vartheta +b\sin m\vartheta) \,\sin\varphi \,d\varphi \,d\vartheta \\ 
     &= 
     \begin{cases}
       r^n P_n^m(\cos\phi) (a\cos m\theta +b\sin m\theta)& \text{ for } l=n \\ 
       0 & \text{ for } l \neq n 
     \end{cases}
    \end{align*}$$

---

* This means that any homogeneous polynomial of degree $l$ which is a solution of Laplace's equation can be written as a linear combination of the $2l+1$ spherical harmonics $r^l \,P_l^m(\cos\phi)\cos m\theta$ and $r^l \,P_l^m(\cos\phi)\sin m\theta$. $\,$The kernel $K_n(\phi,\theta;\varphi,\vartheta)$ has the property that it reproduces all homogeneous harmonic polynomials of degree $n$, $\,$ and reduces those of other degrees to zero

. . .

* Since rotation of the coordinate axes takes a homogeneous harmonic polynomial of degree $l\,$ into another such polynomial in the new variable, $~$ the kernel $K_n$ must be unchanged by such a rotation. $~$ That is, $\,$ if the new polar coordinates are $(r',\phi',\theta')$, $~$ we have $K_n(\phi,\theta;\varphi,\vartheta)=K_n(\phi',\theta';\varphi',\vartheta')$. $~$ In particular, $\,$ we can rotate our coordinates so that the new $z$-axis passes through $(r,\phi,\theta)$; $~$ that is, $~$ so that $\phi'=0$

---

* By definition, $P_n(1)=1$. On the other hand, $\,P_n^m(x)$ with $m \geq 1$ has a factor $\left(1 -x^2\right)^{m/2}$, $\;$so that $P_n^m(1)=0$, $\,$for $m \geq 1$. $\,$Therefore 

  $$ K_n(\phi,\theta;\varphi,\vartheta) =K_n(0,\theta';\varphi',\vartheta')= \frac{2n+1}{4\pi} P_n(\cos\varphi') $$ {#eq-sp-4}

  where $\varphi'$ is the angle between the direction $(\phi,\theta)$ and $(\varphi,\vartheta):$

  $$ \cos\varphi'=\cos\phi\cos\varphi +\sin\phi\sin\varphi \cos(\theta-\vartheta) $$

--- 

  Substituting the identity @eq-sp-4 in @eq-sp-3, $\,$ we find

  $$\begin{align*}
    K(r,\phi,\theta;R,\varphi,\vartheta) &= \frac{1}{4\pi} \sum_{n=0}^\infty (2n +1) \left( \frac{r}{R} \right)^n P_n(\cos\varphi')\\ 
    &= \frac{1}{4\pi} \left( 2r\frac{\partial }{\partial r} +1 \right) \sum_{n=0}^\infty \left( \frac{r}{R} \right)^n P_n(\cos\varphi')
  \end{align*}$$

---

* Evaluating the generating function at $x=\cos\varphi'$ and $\displaystyle \,t=\frac{r}{R}$, $~$ we have the identity

  $$ \frac{R}{\sqrt{r^2 +R^2 -2rR\cos\varphi'}} = \sum_{n=0}^\infty \left( \frac{r}{R}\right)^n P_n(\cos\varphi') $$

  Since

  $$ \scriptsize \left( 2r\frac{\partial}{\partial r} +1\right)\frac{R}{\sqrt{r^2 +R^2 -2rR\cos\varphi'}} = \frac{R\left(R^2 -r^2\right)}{\left(r^2 +R^2 -2rR\cos\varphi'\right)^{3/2}}= \frac{\displaystyle 1 -\left(\frac{r}{R}\right)^2}{\displaystyle\left(1 +\left(\frac{r}{R}\right)^2 -2\frac{r}{R}\cos\varphi'\right)^{3/2}} $$

---

  thus, the solution formula is equivalent to the integral formula

  $$ \scriptsize \color{red}{u(r,\phi,\theta)=\frac{1}{4\pi} \int_0^{2\pi} \int_0^\pi 
 \frac{\displaystyle 1 -\left(\frac{r}{R}\right)^2}{\displaystyle\left(1 +\left(\frac{r}{R}\right)^2 -2\frac{r}{R}\cos\varphi'\right)^{3/2}} \, g(\varphi,\vartheta) \sin\varphi \,d\varphi \, d\vartheta} $$
 
  where $\left(r^2 +R^2 -2rR\cos\varphi'\right)^{1/2}$ is the distance from the point $(r,\phi,\theta)$ to the point $(R,\varphi,\vartheta)$. This is **Poisson's integral formula** in three dimensions


### Lesson 36. A Nonhomogeneous Dirichlet Problem (Green's Function) 

* A common problem in applied mathematics is to find the potential in some region of space in response to a forcing term $f$. $~$A typical example would be to find the potential inside a circle in two dimensions that satisfies

  $$ u_{rr} +\frac{1}{r}u_r + \frac{1}{r^2} u_{\theta\theta}=-f(r,\theta), \;\;\;0 < r < 1 $$

  $$ u(1,\theta) = 0, \;\;\; 0 \leq \theta < 2\pi $$

. . .

* Note that we have chosen the boundary values to be zero. <font color="red">If we wanted to solve the general case, where both the equation and BC were nonhomogeneous, $~$we could add the Poisson integral formula from Lesson 33 to the solution from this Lesson</font>

---

* In order to gain a little intuition about nonhomogeneous differential equations, $~$let's consider graphing the solution to the following Poisson's equation:

  $$ u_{rr} +\frac{1}{r}u_r + \frac{1}{r^2} u_{\theta\theta}=-q, \;\;\;0 < r < 1 $$

  $$ u(1,\theta) = 0, \;\;\; 0 \leq \theta < 2\pi $$

  Here, the potential is fixed at zero on the boundary, $~$and the Laplacian of $u$ is always equal to $-q$ inside the circle. $\,$Since $\nabla^2 u(p)$ measures the difference between $u(p)$ and the average of its neighbors, it will look like a thin membrane fixed at the boundary that was continuously being pushed up by a stream of air from below

---

### Potentials from Point Sources and Sinks

* <font color="blue">In solving a nonhomogeneous linear equation, $~$it is sufficient to solve the equation with a point source since we can find the solution to the general problem by summing the responses to point sources.</font> $~$Our goal here is to find the potential in some region of space due to a point source (or sink)

. . .

* Suppose we have a single point source of magnitude $q$ located at the origin. $~$It is clear that the heat will flow outward along radial lines, and, hence, $~$if we compute the total outward flux across a circle of radius $r$, $~$we have

  $$ \text{Total outward flux across the circle }=-\int_0^{2\pi} \underbrace{u_r(r)}_{<\,0}\, r\,d\theta = -2\pi r\, u_r(r)$$

---

But the outward flux must be equal to the heat generated within the circle (conservation of energy), $~$so we have

$$-2\pi r u_r(r) = q$$

Solving this simple differential equation for $u_r(r)$, $~$we get

$$ u(r)=\frac{q}{2\pi} \ln \frac{1}{r} $$

A sink, on the other hand, is represented by a negative source, and so a sink with magnitude $-q~$ would give rise to a potential field

$$ u(r)=-\frac{q}{2\pi} \ln \frac{1}{r} $$

---

#### Poisson's Equation Inside a Circle

We will now solve the important problem

$$ u_{rr} +\frac{1}{r}u_r + \frac{1}{r^2} u_{\theta\theta}=-f(r,\theta), \;\;\;0 < r < 1 $$

$$ u(1,\theta) = 0, \;\;\; 0 \leq \theta < 2\pi $$

---

The Green function technique (impulse-response method) consists of two steps:

1. Finding the potential $G(r,\theta,\rho,\phi)$ at $(r,\theta)$, $~$which we force to be zero on the boundary and which is due to a single charge (magnitude 1) at $(\rho,\phi)$

2. Summing the individual responses $G(r,\theta,\rho,\phi)$ weighted by $f(\rho,\phi)$ over all $(\rho,\phi)$ in the circle to get the solution

$$ u(r,\theta)=\int_0^{2\pi} \int_0^1 G(r,\theta,\rho,\phi)\, f(\rho,\phi)\,\rho\, d\rho d\phi$$

---

**STEP 1** $\text{ }$ Since the function

$$ \frac{1}{2\pi} \ln \frac{1}{R} $$

is the potential at $(r,\theta)$ due to a single unit charge at $(\rho,\phi)$, $~$where $R$ is the distance from $(r,\theta)$ to $(\rho,\phi)$, $~$the only thing left to do is to modify the function so that it is zero on the boundary

. . .

$~$

**STEP 2** $\text{ }$ The strategy is to place a sink outside the circle at such a point that the potential due to both is constant on the circle at $r=1$. We can then subtract this constant value to obtain a zero potential on the boundary. The big question is, of course, where do we place the sink outside circle, so that the potential on the boundary is constant?

---

Without going into the details, $~$we can show rather easily that if the sink is placed at $(1/\rho,\phi)$, then the potential due to the source and the sink will be constant on the circle $r=1$  

$$\begin{align*} \displaystyle u^*(r,\theta) &= \frac{1}{2\pi} \ln \frac{1}{R} -\frac{1}{2\pi} \ln \frac{1}{\bar{R}} 
   = \frac{1}{2\pi} \ln\frac{\bar{R}}{R} \\
   &=\frac{1}{2\pi} \ln \frac{\sqrt{r^2 +1/\rho^2 -2r/\rho \cos(\theta-\phi)}}{\sqrt{r^2 +\rho^2 -2r\rho \cos(\theta -\phi)}} \\
   &\Downarrow \;\; r=1 \\
   u^*(1,\theta) &= -\frac{1}{2\pi} \ln \rho
\end{align*}$$

With these steps in mind, $~$we construct Green's function

$$ G(r,\theta,\rho,\phi)=\frac{1}{2\pi}\ln \frac{1}{R} -\frac{1}{2\pi}\ln \frac{1}{\bar{R}} + \frac{1}{2\pi}\ln \rho $$

---

<center><img src="figures/pde03_figure13.jpg" alt="potential field due to two opposite" width="1100"/></center>

To find the solution to our orginal problem, $~$we merely superimpose the impulse functions; $~$this brings us to the final step

---

**STEP 3** $\text{ }$ This step is easy; $~$we just write

$$ \color{red}{u(r,\theta) = \frac{1}{2\pi} \int_0^{2\pi} \int_0^1 \ln \left(\rho\frac{\bar{R}}{R}\right) \, f(\rho,\phi)\, \rho\,d\rho\,d\phi} $$ {#eq-nh-1}

This is Green's function solution of Poisson's equation inside a circle

---

**NOTES**

$\textbf{1.}~$ It is also possible to solve

$$ u_{rr} +\frac{1}{r}u_r + \frac{1}{r^2} u_{\theta\theta}=0, \;\;\;0 < r < 1 $$

$$ u(1,\theta) = g(\theta), \;\;\; 0 \leq \theta < 2\pi $$

by means of the Green's function approach

---

Choose any point $(r_0,\phi_0)$ inside a circle. $~$Let $v(r,\phi)$ be any twice continuously differentiable function in a circle such that $v=g$ on the boundary, $~$and $v=0$ near $(r_0,\phi_0)$. $~$Let $w = u -v$. Then $w$ satisfies

$$ \nabla^2w = -\nabla^2v, \;\;\;0 < r < 1 $$

$$ w(1,\theta) = 0, \;\;\; 0 \leq \theta < 2\pi $$

Therefore

$$ w(r_0,\theta_0)=-\int_0^{2\pi} \int_0^1 G(r_0,\theta_0,\rho,\phi)\, \nabla^2 v\,\rho\, d\rho d\phi $$

---

Since $v=0$ near the singularity $(r_0,\theta_0)$ of $G$, $~$we can apply the divergence theorem to the identity

$$ G\nabla^2 v = G \nabla^2 v -v\nabla^2 G = \nabla \cdot \left( G\nabla v -v\nabla G\right)$$

to find that

$$ \begin{align*} w(r_0,\theta_0)&=-\int_0^{2\pi} \int_0^1 G(r_0,\theta_0,\rho,\phi)\, \nabla^2 v\,\rho\, d\rho d\phi \\
 &\Downarrow \;\;{\scriptstyle \text{Divergence Theorem}} \\
 &=-\int_0^{2\pi} G(r_0,\theta_0,1,\phi) \frac{\partial v}{\partial r} -v\frac{\partial G}{\partial r}(r_0,\theta_0,1,\phi)\,d\phi \\
 &\Downarrow \;\;{\scriptstyle \text{ On the boundary } G = 0, \; v = g} \\
 &= \int_0^{2\pi} \frac{\partial G}{\partial r}(r_0,\theta_0,1,\phi) \,g(\phi)\,d\phi 
\end{align*} $$

---

But $v(r_0,\theta_0)=0$, $~$ so that $w(r_0,\theta_0)=u(r_0,\theta_0).$ $~$ Since $(r_0,\theta_0)$ was any point in a circle, $~$ the solution is

$$ u(r,\theta) = \int_0^{2\pi} \frac{\partial G}{\partial r}(r,\theta,1,\phi)\,g(\phi)\,d\phi $$

which, $\,$ if we compute $\displaystyle\frac{\partial G}{\partial r}$, $\,$ gives

$$ u(r,\theta) = \frac{1}{2\pi} \int_0^{2\pi} \left[ \frac{1 - r^2}{1 +r^2 -2r\cos(\theta -\phi)} \right]\,g(\phi)\,d\phi $$ {#eq-nh-2}

which is the Poisson integral formula

---

$\textbf{2.}~$ The solution to the general Dirichlet problem

$$ u_{rr} +\frac{1}{r}u_r + \frac{1}{r^2} u_{\theta\theta}=-f(r,\theta), \;\;\;0 < r < 1 $$

$$ u(1,\theta) = g(\theta), \;\;\; 0 \leq \theta < 2\pi $$

would be the sum of solutions @eq-nh-1 and @eq-nh-2

---

#### Poisson's Equation Inside a Sphere

We consider the problem

$$\begin{align*}
 u_{rr} +\frac{2}{r} u_r &+\frac{1}{r^2}u_{\phi\phi} +\frac{\cot\phi}{r^2} u_{\phi} +\frac{1}{r^2\sin^2\phi}u_{\theta\theta} = -F(r,\phi,\theta), \;\; r < R \\ 
 u(R,\phi,\theta) &= 0\\ 
\end{align*}$$ {#eq-sp-1}

1. Solve by taking the finite Fourier Transforms

2. Derive $\,G(r,\phi,\theta; \rho,\varphi,\vartheta)\,$ in the equivalent integral formula:

$$ u(r,\phi,\theta) = \int_0^{2\pi} \int_0^\pi \int_0^R G(r,\phi,\theta; \rho,\varphi,\vartheta)\, F(\rho, \varphi,\vartheta) \,\rho^2 \sin\varphi \,d\rho \,d\varphi \, d\vartheta $$

---

**(a)** $\text{ }$ We expand $u$ and $F$ in Fourier series in $P_n^m(\cos\phi)\cos m\theta$ and $P_n^m(\cos\phi)\sin m\theta$. $~$That is, $~$we take their finite Fourier transforms:

$$\tiny\begin{align*}
 a_{nm}(r) &= \frac{2n +1}{2\pi} \frac{(n -m)!}{(n +m)!}
  \int_{0}^{2\pi} \int_{0}^\pi u(r,\phi,\theta) \,P_n^m(\cos\phi) \,\cos m\theta \,\sin\phi \,d\phi \,d\theta\\ 
 b_{nm}(r) &= \frac{2n +1}{2\pi} \frac{(n -m)!}{(n +m)!}
  \int_{0}^{2\pi} \int_{0}^\pi u(r,\phi,\theta) \,P_n^m(\cos\phi) \,\sin m\theta \,\sin\phi \,d\phi \,d\theta\\ 
 A_{nm}(r) &= \frac{2n +1}{2\pi} \frac{(n -m)!}{(n +m)!}
  \int_{0}^{2\pi} \int_{0}^\pi F(r,\phi,\theta) \,P_n^m(\cos\phi) \,\cos m\theta \,\sin\phi \,d\phi \,d\theta\\ 
 B_{nm}(r) &= \frac{2n +1}{2\pi} \frac{(n -m)!}{(n +m)!}
  \int_{0}^{2\pi} \int_{0}^\pi F(r,\phi,\theta) \,P_n^m(\cos\phi) \,\sin m\theta \,\sin\phi \,d\phi \,d\theta
\end{align*}$$

Taking finite Fourier transforms of the differential equation and integrating by parts leads to the system

$$\scriptsize\begin{align*}
 r^2 a_{nm}'' +2r a_{nm}' &-n(n +1) a_{nm} = -r^2 A_{nm}, \; 
 a_{nm}(R)= 0, \;a_{nm} \sim \text{bounded}\\ 
 r^2 b_{nm}'' +2r b_{nm}' &-n(n +1) b_{nm} = -r^2 B_{nm}, \; 
 b_{nm}(R)= 0, \;b_{nm} \sim \text{bounded} 
\end{align*}$$

---

These problems have the solutions

$$\begin{align*}
 a_{nm}(r) &=\int_0^R G_n(r,\rho)\,A_{nm}(\rho)\,\rho^2 \,d\rho \\ 
 b_{nm}(r) &=\int_0^R G_n(r,\rho)\,B_{nm}(\rho)\,\rho^2 \,d\rho
\end{align*}$$ {#eq-sp-2}

where (See Appendix: Green's Function)

$$ \scriptsize G_n(r,\rho) = 
\begin{cases}
 \displaystyle\frac{1}{(2n +1)R}\left(\frac{r}{R} \right)^n\left[\left(\frac{\rho}{R} \right)^{-(n+1)} -\left(\frac{\rho}{R} \right)^{n} \right] & \text{ for } r \leq \rho \\ 
 \displaystyle\frac{1}{(2n +1)R}\left(\frac{\rho}{R} \right)^n\left[\left(\frac{r}{R} \right)^{-(n+1)} -\left(\frac{r}{R} \right)^{n} \right]& \text{ for } r \geq \rho 
\end{cases}$$

If the problem @eq-sp-2 has a solution, $~$it is

$$ u(r,\phi,\theta) = \sum_{n=0}^\infty \left[ \frac{1}{2} a_{n0}(r) P_n(\cos\phi) +\sum_{m=1}^n \left(a_{nm}(r) \cos m\theta +b_{nm}(r) \sin m\theta \right) P_n^m(\cos\phi) \right]\;\;$$ {#eq-sp-3}

---

**(b)** $\text{ }$ We substitute the definitions of $A_{nm}(r)$ and $B_{nm}(r)$ in @eq-sp-2, $~$and formally interchange integration and summation in @eq-sp-3. $~$This process gives the formal solution 

$$ u(r,\phi,\theta) = \int_0^{2\pi} \int_0^\pi \int_0^R G(r,\phi,\theta; \rho,\varphi,\vartheta)\, F(\rho, \varphi,\vartheta) \,\rho^2 \sin\varphi \,d\rho \,d\varphi \, d\vartheta $$

where for $r > \rho$

$$\scriptsize \begin{align*}
 G(r,\phi,\theta;\rho,\varphi,\vartheta) &=\sum_{n=0}^\infty \frac{1}{(2n +1)R}
  \left(\frac{\rho}{R} \right)^n 
  \left[ \left(\frac{r}{R} \right)^{-(n +1)} -\left(\frac{r}{R} \right)^{n} \right] 
  K_n(\phi,\theta;\varphi,\vartheta)\\ 
 &= \frac{1}{4\pi R} \sum_{n=0}^\infty \left(\frac{\rho}{R} \right)^n 
  \left[ \left(\frac{r}{R} \right)^{-(n +1)} -\left(\frac{r}{R} \right)^{n} \right] P_n(\cos\varphi') 
\end{align*}$$

For $r < \rho$, $~$we must only interchange $r$ and $\rho$ in this formula

---

To evaluate the series in the above equation, $~$we use the generating function:

$$\begin{align*}
 G(r,\phi,\theta;\rho,\varphi,\vartheta) &=\frac{1}{4\pi} \frac{1}{\sqrt{r^2+\rho^2-2r\rho\cos\varphi'}}
 -\frac{1}{4\pi} \frac{1}{\sqrt{R^2 +\frac{r^2\rho^2}{R^2} -2r\rho\cos\varphi'}}
\end{align*}
$$

This, then, is the Green's function for $r > \rho$. $~$It is already symmetric in $r$ and $\rho$, $~$so that the same formula holds for $r < \rho$, and even for $r=\rho$. $~$We note that $G=0$ for $r=R$


### Lesson 37. Hydrogen Atom

As the electron circles around the nucleus, $\,$the system (the proton and the electron) rotates around the center of gravity. $\,$For the rotating system, $\,$we can write the reduced mass, $\mu$, as

$$ \frac{1}{\mu} = \frac{1}{m_e} + \frac{1}{m_p} $$

or

$$ \mu = \frac{m_em_p}{m_e +m_p} $$

Since the mass of the electron is so much less than that of the proton, $\,$ $m_e +m_p \approx m_p$ and $\mu = m_e$. $\,$ Assuming that the nucleus is stationary and that the electron does all of the moving (known as the Born-Oppenheimer approximation) leads to the same result

---

The Hamiltonian can be written as the sum of the kinetic and potential energies

$$H = T + V$$

in which $T = p^2/2\mu\,$ and the potential energy, $\,V$, $~$for the interaction of the electron with the proton is $-e^2/r$. $\,$ Therefore, $~$ the Hamiltonian operator $H$ is

$$ H=-\frac{\hbar^2}{2\mu} \nabla^2 -\frac{e^2}{r} $$

---

Therefore, $\,$ the time-independent wave function $\psi$ gives

$$\scriptsize\begin{align*}
 H \psi &= E \psi \\ 
 &\Downarrow \\
 \nabla^2 \psi +\color{red}{\frac{2\mu}{\hbar^2}} &\color{red}{\left( \frac{e^2}{r} +E \right) \psi} =0 \\
 &\Downarrow \\
 \frac{1}{r^2}\left( r^2 \psi_r \right)_r +\frac{1}{r^2\sin\phi} \left( \sin\phi\, \psi_\phi \right)_\phi 
  &+\frac{1}{r^2\sin^2\phi} \psi_{\theta\theta} +\frac{2\mu}{\hbar^2} \left( \frac{e^2}{r} +E \right) \psi =0 
\end{align*}$$

---

We assume that $\psi(r,\phi,\theta)=R(r)\,\Phi(\phi)\,\Theta(\theta)$ and make the substitution. $\,$For simplicity, $\,$we will write the partial solutions as $R$, $\Phi$, and $\Theta~$ without showing the functionality. $\,$We now divide both sides by $R\,\Phi\,\Theta$ and multiply by $r^2\sin^2\phi$:

$$ \scriptsize\frac{\sin^2\phi}{R}\left( r^2 R_r \right)_r +\frac{\sin\phi}{\Phi} \left( \sin\phi\, \Phi_\phi \right)_\phi 
  +\frac{1}{\Theta} \Theta_{\theta\theta} +\frac{2\mu r^2\sin^2\phi}{\hbar^2} \left( \frac{e^2}{r} +E \right) =0 $$

---

Inspection shows that, of the four terms on the left side of the equation, there is no functional dependence on $\theta$ except in the third term. $\,$Therefore, with respect to the other variables, $\,$the third term can be treated as a constant:

$$\scriptsize\begin{align*}
 -\frac{\sin^2\phi}{R}\left( r^2 R_r \right)_r -\frac{\sin\phi}{\Phi} \left( \sin\phi\, \Phi_\phi \right)_\phi 
  &-\frac{2\mu r^2\sin^2\phi}{\hbar^2} \left( \frac{e^2}{r} +E \right) 
  = \frac{1}{\Theta} \Theta_{\theta\theta} = -\lambda <0 \\ 
 &\Downarrow \\
 \Theta_{\theta\theta} &+\lambda \Theta = 0, \;\;\Theta(0)=\Theta(2\pi)\\
  &\Downarrow \;\;e^{\pm i2\pi \sqrt{\lambda}} =1\\
  \lambda_m = m^2, &\;m=0,\pm 1, \pm 2,\cdots \\ 
  \Theta_m(\theta) &= \frac{1}{\sqrt{2\pi}} e^{im\theta} 
\end{align*}$$

Actually, $\,$there are two solutions: $e^{im\theta}$ and $e^{-im\theta}$, $\,$but we cover the latter by allowing $m$ to run negative

---

We can now write the wave equation as

$$\scriptsize \frac{\sin^2\phi}{R}\left( r^2 R_r \right)_r +\frac{\sin\phi}{\Phi} \left( \sin\phi\, \Phi_\phi \right)_\phi 
  -m^2 +\frac{2\mu r^2\sin^2\phi}{\hbar^2} \left( \frac{e^2}{r} +E \right) 
  = 0$$
  
If we divide the equation by $\sin^2\phi$ and rearrange, $~$we obtain

$$\scriptsize \begin{align*}
 \frac{1}{R}\left( r^2 R_r \right)_r +\frac{2\mu r^2}{\hbar^2} \left( \frac{e^2}{r} +E \right) &+\frac{1}{\Phi\sin\phi} 
  \left( \sin\phi\, \Phi_\phi \right)_\phi -\frac{m^2}{\sin^2\phi} = 0 \\
 &\Downarrow \\
  \frac{1}{\Phi\sin\phi} \left( \sin\phi\, \Phi_\phi \right)_\phi &-\frac{m^2}{\sin^2\phi} = -\beta \\
  \frac{1}{R}\left( r^2 R_r \right)_r +\frac{2\mu r^2}{\hbar^2} &\left( \frac{e^2}{r} +E \right) = \beta \\
 &\Downarrow 
  \end{align*}$$

---

$$ \scriptsize \begin{align*}
  &\Downarrow \\
  \frac{1}{\sin\phi} \left( \sin\phi\, \Phi_\phi \right)_\phi &+\left( \beta-\frac{m^2}{\sin^2\phi}\right)\Phi = 0 \\
  \frac{1}{r^2}\left( r^2 R_r \right)_r +\color{red}{\frac{2\mu}{\hbar^2}} &\color{red}{\left( \frac{e^2}{r} +E \right)R -\frac{\beta}{r^2}R}=0
\end{align*}$$

---

We will now turn our attention to the equation involving $\phi$. The standard method for solving this equation is to make the transformation $x=\cos\phi$

$$\scriptsize\begin{align*}
 \frac{1}{\sin\phi} \frac{d}{d\phi} \left( \frac{\sin^2\phi}{\sin\phi}\, \frac{d\Phi}{d\phi} \right) &+\left( \beta-\frac{m^2}{\sin^2\phi}\right)\Phi = 0 \\ 
 &\Downarrow\;\;x=\cos\phi,\;dx=-\sin\phi\,d\phi \\ 
 \frac{d}{dx} \left[ \left(1 -x^2\right) \frac{d\Phi}{dx} \right] &+ \left( \beta-\frac{m^2}{1 -x^2}\right)\Phi = 0 \\ 
 &\Downarrow \\
 \left(1 -x^2\right) \frac{d^2\Phi}{dx^2} -2x \frac{d\Phi}{dx} &+ \left( \beta-\frac{m^2}{1 -x^2}\right)\Phi = 0 
\end{align*}$$

---

This is the associated Legendre equation. If you start with the Legendre equation and differentiate it $|m|$ times, $\,$you end up with a new differential equation 

$$\scriptsize\begin{align*}
 \left(1 -x^2\right)P_l''(x) -\,&\,2xP_l'(x) +l(l+1)P_l(x) = 0,\;\;\; l=0,1,2,\cdots \\ 
 &\Downarrow\;\; {\scriptstyle \text{differentiate it } |m| \text{ times}, \;\;y = \left(\frac{d}{dx}\right)^{|m|} P_l(x),\; \; |m|\, \leq\, l} \\ 
 \left(1 -x^2\right)y'' -2 |m| x y'&-|m|(|m| -1)y -2x y' -2|m|y +l(l +1)y = 0\\ 
 &\Downarrow\\ 
 \left(1 -x^2\right)y'' -2x(|m| +1)&y' +\left[l(l +1) -|m|(|m| +1)\right] y = 0 
\end{align*}$$

---

And the substitution

$$\scriptsize\begin{align*}
 y&= \left(1 -x^2\right)^{-|m|/2} \Phi \\ 
 y'&= \left(1 -x^2\right)^{-|m|/2} \left[\frac{d\Phi}{dx} +\frac{|m|x}{1 -x^2}\Phi \right] \\ 
 y''&= \left(1 -x^2\right)^{-|m|/2} \left[\frac{d^2\Phi}{dx^2} +\frac{2|m|x}{1 -x^2}\frac{d\Phi}{dx} 
  +\frac{|m|+|m|x^2 +|m|^2x^2}{(1-x^2)^2} \Phi \right]
\end{align*}$$

puts the equation into standard form with respect to $\Phi$. $\,$Then the standard solutions of the associated Legendre equation were found to be

$$\scriptsize \Phi(x) = P_l^{|m|}(x) = \left(1 -x^2\right)^{|m|/2} \left(\frac{d}{dx}\right)^{|m|} P_l(x) = \left(1 -x^2\right)^{|m|/2} \frac{1}{2^l l!} \left(\frac{d}{dx}\right)^{|m|+l} \left(x^2 -1\right)^l $$

and $P_l^{|m|}(x)$ are orthogonal with the weight function $1$

$$ \scriptsize \int_{-1}^1 P_l^{|m|}(x)\, P_{l'}^{|m|}(x)\,dx = \frac{2}{2l +1} \frac{(l +|m|)!}{(l -|m|)!} \,\delta_{ll'} $$

---

* Notice that $l$ must be a nonnegative integer. $\,$ For any given $l,$ $\,$ then, $\,$ there are $(2l +1)$ possible values of $m$:

  $$\scriptsize l=0,1,2,\cdots; \;\;m =-l, -1 +1, \cdots, -1, 0, 1, \cdots, l -1, l $$

  For historical reasons, $\,l\,$ is called the azimuthal quantum number, $\,$ and $\,m\,$ the magnetic quantum number

. . .

* The normalized angular wave functions are called <font color="red">spherical harmonics</font>:

  $$ \color{red}{Y_l^{m}(\phi,\theta)=\epsilon \sqrt{\frac{(2l +1)}{4\pi} \frac{(l -|m|)!}{(l +|m|)!}} P_l^{|m|}(\cos\phi) e^{im\theta}} $$

  where $\epsilon=(-1)^m$ for $m \geq 0\,$ and $\,\epsilon=1$ for $m < 0$

---

Notice that the angular part of the wave function, $\,Y(\phi,\theta)$, $\,$is the same for all spherically symmetric potentials; $\,$the actual shape of the potential, $\,V(r)$, $\,$affects only the radial part of the wave function, $\,R(r)$,$\,$ which is determined by

$$ \frac{1}{r^2}\left( r^2 R_r \right)_r +\frac{2\mu}{\hbar^2} \left( \frac{e^2}{r} +E \right)R -\frac{l(l +1)}{r^2}R=0$$

This equation simplifies if we change variables:

$$\tiny \begin{align*}
 \text{Let } u(r) &= rR(r) \\ 
 &\Downarrow \;{\tiny\text{so that}} \\ 
 R = \frac{u}{r}, \;\; \frac{dR}{dr} = \frac{1}{r^2} &\left( r\frac{du}{dr} -u \right), \;\; \frac{d}{dr} \left[ r^2 \frac{dR}{dr} \right] = r\frac{d^2 u}{dr^2} \\
 &\Downarrow 
 {\tiny \kappa = \frac{\sqrt{-2\mu E}}{\hbar}\;\;\text{ and } \;\rho_0 = \frac{2\mu e^2}{\hbar^2 \kappa}} \\
 \frac{d^2u}{dr^2} =\left[-\frac{\rho_0 \kappa}{ r} +\kappa^2 +\frac{l(l +1)}{r^2} \right] u \;\;&\overset{\rho=\kappa r}{\rightarrow}\;\;\frac{d^2u}{d\rho^2} =\left[1 -\frac{\rho_0}{\rho}\right. +\left.\frac{l(l +1)}{\rho^2} \right] u
\end{align*}$$

---

The next step is to peel off the asymptotic behavior, $\,$introducing the new function $v(\rho)$

$$u(\rho)=\rho^{l +1} e^{-\rho} v(\rho)$$

in the hope that $v(\rho)$ will turn out to be simpler than $u(\rho)$. In terms of $v(\rho)$, $\,$ then, $\,$ the radial equation reads

$$ \rho \frac{d^2v}{d\rho^2} +2(l +1 -\rho) \frac{dv}{d\rho} +\left[ \rho_0 -2(l +1) \right]v=0 $$

. . .

Finally, $\,$ we assume the solution can be expressed as a power series in $\rho$:

$$ v(\rho) = \sum_{k = 0}^\infty c_k \rho^k $$

Inserting the power series into the equation and equating the coefficients of like powers yields

$$ c_{k +1} = \frac{2(k +l +1) -\rho_0}{(k +1)(k +2l +2)} c_k$$

---

<font size="6px">Now let's see what the coefficients look like for large $k$. In this regime the recursion formula says

$$ \scriptsize c_{k +1} \approx \frac{2}{k +1} c_k$$

Suppose for a moment that this were exact. Then

$$ \scriptsize c_k = \frac{2^k}{k!} c_0$$

so

$$ \scriptsize v(\rho) = c_0 \sum_{k=0}^\infty \frac{2^k}{k!} \rho^k = c_0 e^{2\rho}$$

and hence

$$ \scriptsize u(\rho)=c_0\rho^{l +1} e^\rho $$

which blows up at large $\rho$. The positive exponential is precisely the asymptotic behavior we didn't want</font>

---

<font size="6px">There is only one way out of this dilemma: *The series must terminate*. There must occur some maximal integer, $\,k_{max}$, $\,$ such that

$$ c_{k_{max}\, +1} = 0 $$

and beyond which all coefficient vanish automatically. $\,$ Evidently

$$ 2(k_{max} +l +1) -\rho_0 = 0 $$

Defining the so-called principle quantum number

$$ n = k_{max} +l +1 $$

we have 

$$ \rho_0 = 2n $$

</font>

---

But $\,\rho_0$ determine $E$

$$ E = -\frac{\hbar^2 \kappa^2}{2 \mu} = -\frac{2\mu e^4}{\hbar^2 \rho_0^2} $$

so the allowed energies are

$$ E_n = - \left[ \frac{\mu e^4}{2\hbar^2} \right] \frac{1}{n^2}, \;\;\;n=1,2,3,\cdots $$

This is the famous **Bohr formula**. The ground state (that is, $\,$the state of lowest energy) is the case $n=1$; $\,$putting in the accepted values for the physical constants, $\,$we get

$$ E_1 = - \left[ \frac{\mu e^4}{2\hbar^2} \right] =-13.6\,eV $$

---

and we find that 

$$ \kappa = \frac{\mu e^2}{\hbar^2} \frac{1}{n} = \frac{1}{a_0 n},\;\;\rho = \frac{r}{a_0 n} $$

where

$$ a_0 = \frac{\hbar^2}{\mu e^2} = 0.529 \times 10^{-10} m $$

is the so-called **Bohr radius**

---

 Anyway the radial equation gives

$$ \color{red}{R_{nl}(r) = \frac{1}{r} \rho^{l +1} e^{-\rho} v(\rho)} $$

in which $v(\rho)$ is a polynomial of degree $\,k_{max} = n -l -1\,$ in $\, \rho,$ whose coefficients are determined by the recursion formula

$$ c_{k +1} = \frac{2(k +l +1 -n)}{(k +1)(k +2l +2)} c_k $$

<font size="5px">
For arbitrary $n$, $\,$ the possible values of $\,l\,$ are

$$ l=0,1,2,\cdots,n-1 $$

and for each $l$, $\,$ there are $(2l +1)$ possible values of $m$, $\,$ so the total degeneracy of the energy level $E_n$ is

$$ d(n)=\sum_{l=0}^{n-1}(2l +1)=n^2 $$

</font>

---

The polynomial $v(\rho)$ is a function well known to applied mathematicians;  $\,$it can be written as

$$ \color{red}{v(\rho) = L_{n -l -1}^{2l +1}(2\rho)} $$

where

$$ L_{q-p}^p(x)=(-1)^p \left( \frac{d}{dx} \right)^p L_q(x) =\sum_{k=0}^{q-p} \frac{(-1)^k}{k!} \binom{q}{q-p-k} x^k $$

is a generalized Laguerre polynomial, and

$$ L_q(x) =\frac{e^x}{q!} \left( \frac{d}{dx} \right)^q (e^{-x} x^q) = \sum_{k=0}^q \frac{(-1)^k}{k!} \binom{q}{k} x^k  $$

is the $q$-th Laguerre polynomial

---

The radial wave functions are given by

$$ \color{red}{R_{nl}(r) = \sqrt{\left( \frac{2}{na_0}\right)^3 \frac{(n -l -1)!}{2n (n +l)!}} e^{-r/na_0}
\left( \frac{2r}{na_0} \right)^l \, L_{n -l -1}^{2l +1} \left( \frac{2r}{na_0} \right)} $$

The combinatorial factor in front assures that $R_{nl}(r)$ are normalized with respect to an integration over $r$:

$$ \int_0^\infty R^2_{nl}(r) \, r^2 dr = 1$$

Note that the volume element here is $r^2 dr$, which is the $r$ part of the spherical coordinate volume element $r^2 \sin \phi \,dr \,d\phi \,d\theta$

---

The complete hydrogen atomic wave functions are

$$ \color{red}{\psi_{nlm}(r, \phi, \theta) = R_{nl}(r)\,Y_l^m(\phi,\theta)} $$

The normalization condition is

$$ \scriptsize\int_0^{2\pi} \int_0^{\pi} \int_0^\infty \psi_{nlm}^2(r,\phi,\theta) \,r^2 \sin\phi \,dr \,d\phi \, d\theta = 1 $$

The functions $\psi_{nml}$ must also be orthogonal. This orthonomality relationship is given by

$$ \scriptsize\int_0^{2\pi} \int_0^{\pi} \int_0^\infty \psi^*_{nlm}(r',\phi',\theta')\,\psi_{nlm}(r,\phi,\theta) \,r^2 \sin\phi \,dr \,d\phi \, d\theta = \delta_{nn'} \delta_{ll'}\delta_{mm'}$$


### Appendix: Green's Function

#### 1. Initial Value Problems of the $2_{\text{nd}}$-order Ordinary Differential Equations

* We shall consider the self-adjoint form

  $$ \frac{d}{dx} \left[ p(x)\frac{du}{dx} \right] +q(x)u = -f(x) $$ {#eq-gf-1}

  The function $p(x)$ is continuously differentiable and positive, $~$and $q(x)$ and $f(x)$ are continuous for $\alpha < x < \beta$

. . .

* The homogeneous $2_{\text{nd}}$-order differential equation

  $$ \frac{d}{dx} \left[ p(x)\frac{dv}{dx} \right] +q(x)v = 0 $$ {#eq-gf-2}

  has exactly two linearly independent solutions $v_1(x)$ and $v_2(x)$: any solution of @eq-gf-2 can be written in the form

  $$ v(x) = c_1 v_1(x) +c_2 v_2(x) $$

  where $c_1$ and $c_2$ are constants

---

* We now consider the function

  $$\scriptsize w = v_1(x) \int_\alpha^x v_2(\xi) \, f(\xi)\, d\xi -v_2(x) \int_\alpha^x v_1(\xi) \,f(\xi)\, d\xi $$

  Differentiating $w$, $~$we have

  $$\scriptsize\begin{align*}
   \frac{dw}{dx} &= v_1'(x) \int_\alpha^x v_2(\xi) \,f(\xi)\, d\xi -v_2'(x) \int_\alpha^x v_1(\xi) \,f(\xi)\, d\xi  
   + \underbrace{\left[ v_1(x) v_2(x) -v_2(x) v_1(x) \right]}_{=\,0} \,f(x)\\ 
  &= v_1'(x) \int_\alpha^x v_2(\xi) \,f(\xi)\, d\xi -v_2'(x) \int_\alpha^x v_1(\xi) \,f(\xi)\, d\xi 
  \end{align*}$$

---

Then

$$\scriptsize\begin{align*}
 \frac{d}{dx}\left[ p(x)\frac{dw}{dx} \right] &=  \underbrace{\frac{d}{dx}\left[ p(x)v_1'(x) \right]}_{-q(x)v_1} \int_\alpha^x v_2(\xi) \,f(\xi)\, d\xi -\underbrace{\frac{d}{dx}\left[ p(x)v_2'(x) \right]}_{-q(x) v_2} \int_\alpha^x v_1(\xi) \,f(\xi)\, d\xi \\
 &+ \underbrace{p(x) \left[ v_1'(x) v_2(x) -v_2'(x) v_1(x) \right]}_{-K} \,f(x) \\
 &=-q(x) w -Kf(x)
\end{align*}$$

where

$$\scriptsize\begin{align*}
 \frac{d}{dx} &\left\{p(x) \left[ v_1'(x) v_2(x) -v_2'(x) v_1(x) \right] \right\} \\ 
 &= \underbrace{\frac{d}{dx} \left[ p(x) v_1'(x) \right]}_{-q(x) v_1(x)} v_2(x) -\underbrace{\frac{d}{dx} \left[ p(x) v_2'(x) \right]}_{-q(x)v_2(x)} v_1(x) +p(x)v_1'(x)v_2'(x) -p(x)v_2'(x)v_1'(x)\\ 
 &= 0 \\
 &\Downarrow \\
 p(x) &\left[ v_1'(x) v_2(x) -v_2'(x) v_1(x) \right] = -K = \text{constant}
\end{align*}$$

---

* We have shown that $\,w\,$ satisfies the equation:

  $$ \scriptsize \frac{d}{dx} \left[ p(x)\frac{dw}{dx} \right] +q(x)w = -Kf(x) $$

  Moreover, $~$ as $x \rightarrow \alpha$, $\,w(\alpha)=w'(\alpha)=0$

. . .

* Dividing by the constant $K$, $~$we find that the function

  $$ \scriptsize u(x) = \int_\alpha^x R(x,\xi)\,f(\xi)\,d\xi $$ {#eq-gf-3}

  where

  $$ \scriptsize R(x,\xi)=\frac{v_1(x)v_2(\xi) - v_2(x)v_1(\xi)}{K}=-\frac{v_1(x)v_2(\xi) - v_2(x)v_1(\xi)}{p(x) \left[ v_1'(x) v_2(x) -v_2'(x) v_1(x) \right]} $$ {#eq-gf-4}

  is the solution of the initial value problem

  $$\begin{align*}
   \frac{d}{dx} &\left[ p(x) \frac{du}{dx}\right] +qu = -f(x)\;\; \text{ for } x > \alpha \\ 
   &u(\alpha) = u'(\alpha) = 0 
   \end{align*}$$

---

* Since the denominator of $R(x,\xi)$ is a constant, $~$the function $R(x,\xi)$ satisfies the homogeneous equation @eq-gf-2 as either a function of $x$ or $\xi$. In fact, 

  $$ R(x,\xi)=-R(\xi,x)$$

  For a fixed value of $\xi$, $~R(x,\xi)$ is completely characterized as the solution of the homogeneous initial value problem

  $$\begin{align*}
     \frac{d}{dx} \left[ p(x) \frac{dR}{dx}\right] &+q(x)R = 0\;\; \text{ for } x > \xi \\ 
     \left. R \right|_{x=\xi} &= 0 \\ 
     \left. R' \right|_{x=\xi} &= -\frac{1}{p(\xi)} \\ 
   \end{align*}$$

  The function $R(x,\xi)$ describes the influence on the value of $u$ at $x$ of a disturbance(impulse) concentrated at $\xi$. It is sometimes called the **influence function**, or the one-sided Green's function

---

* If the values of $u(\alpha)$ and $u'(\alpha)$ are prescribed to be other than zero, $~$ we must simply add a suitable solution $c_1 v_1(x) +c_2 v_2(x)$ to the expression @eq-gf-3

. . .

$~$

**Example** $\text{ }$ Consider the problem

$$\begin{align*}
 u'' +u &= -f(x)\;\; \text{ for } x > 0 \\ 
 u(0) &= 1 \\ 
 u'(0) &=-1 \\ 
\end{align*}$$

---

**Solution** $\text{ } u(x) = w(x) +v(x)$

**(1)** 
$$\begin{align*}
 w'' +w &= -f(x)\;\; \text{ for } x > 0 \\ 
 w(0) &= 0 \\ 
 w'(0) &= 0 \\ 
\end{align*}$$

For a fixed value of $\xi$, $~$the influence function $R(x,\xi)$ satisfies

$$\begin{align*}
 \frac{d^2R}{dx^2} +R &= 0\;\; \text{ for } x > \xi \\ 
 \left. R \right|_{x=\xi} &= 0 \\ 
 \left. R' \right|_{x=\xi} &= -1 
\end{align*}$$

---

Thus

$$ R(x,\xi)=\sin(\xi -x) $$

and the solution is

$$ w(x)=\int_0^x \sin(\xi -x)\,f(\xi)\,d\xi $$

**(2)**

$$\begin{align*}
 v'' +v &= 0\;\; \text{ for } x > 0 \\ 
 v(0) &= 1 \\ 
 v'(0) &=-1 \\ 
\end{align*}$$

$$ v(x)=\cos x -\sin x $$

---

#### 2. Boundary Value Problems of the $2_{\text{nd}}$-order Ordinary Differential Equations

* Here, $\,$ we research a two-point boundary value problem:

  $$\begin{align*}
     \frac{d}{dx} &\left[ p(x)\frac{du}{dx} \right] +q(x)u = -f(x)\;\; \text{ for } \alpha < x < \beta \\ 
     &\color{red}{u(\alpha)=u(\beta)=0}
   \end{align*}$$ {#eq-gf-5}

  <font size="6px">
  Writing the general solution in the form

  $$ u(x) = \int_\alpha^x R(x,\xi)\,f(\xi)\,d\xi +c_1 v_1(x) +c_2 v_2(x) $$

  we obtain the two equations

  $$\begin{align*}
     c_1 v_1(\alpha) +c_2 v_2(\alpha) &= 0\\ 
     c_1 v_1(\beta) +c_2 v_2(\beta) &= -\int_\alpha^\beta R(\beta,\xi)\,f(\xi)\,d\xi
   \end{align*}$$

  These two equations determine a unique pair of constants $c_1$ and $c_2$, $\,$ provided the determinant of their coefficients is not zero; $\,$ that is, $\,$ provided

  $$ D \equiv v_1(\alpha)v_2(\beta)-v_2(\alpha)v_1(\beta) \neq 0 $$
  </font>

---

<font size="6px">
We assume this for the moment. Then

$$\begin{align*}
 c_1 &= \frac{v_2(\alpha)}{D} \int_\alpha^\beta R(\beta,\xi)\,f(\xi)\,d\xi \\
    &=\frac{v_2(\alpha)}{D} \int_\alpha^x R(\beta,\xi)\,f(\xi)\,d\xi
    +\frac{v_2(\alpha)}{D} \int_x^\beta R(\beta,\xi)\,f(\xi)\,d\xi\\   
 c_2 &= -\frac{v_1(\alpha)}{D} \int_\alpha^\beta R(\beta,\xi)\,f(\xi)\,d\xi \\
    &= -\frac{v_1(\alpha)}{D} \int_\alpha^x R(\beta,\xi)\,f(\xi)\,d\xi
    -\frac{v_1(\alpha)}{D} \int_x^\beta R(\beta,\xi)\,f(\xi)\,d\xi  
\end{align*}$$

The solution can then be written as

$$\begin{align*}
 u(x) &= \int_\alpha^x \left[ R(x,\xi) +\frac{v_2(\alpha)v_1(x) -v_1(\alpha)v_2(x)}{D} R(\beta,\xi) \right]\,f(\xi)\,d\xi\\ 
      &+\int_x^\beta \frac{v_2(\alpha)v_1(x) -v_1(\alpha)v_2(x)}{D}  R(\beta,\xi)\,f(\xi)\,d\xi
\end{align*}$$
</font>

---

<font size="6px">
We find after some algebraic manipulation that

$$\begin{align*}
 G(x,\xi) &=R(x,\xi) +\frac{v_2(\alpha)v_1(x) -v_1(\alpha)v_2(x)}{D} R(\beta,\xi)  \\ 
 &= \frac{v_1(x)v_2(\xi) - v_2(x)v_1(\xi)}{K} \frac{v_1(\alpha)v_2(\beta) -v_2(\alpha)v_1(\beta)}{D} \\
  &\quad +\frac{v_2(\alpha)v_1(x) -v_1(\alpha)v_2(x)}{D} \frac{v_1(\beta)v_2(\xi) - v_2(\beta)v_1(\xi)}{K}\\ 
 &= \frac{\left[v_1(\alpha)v_2(\xi) -v_2(\alpha)v_1(\xi)\right] \left[v_1(x)v_2(\beta) -v_2(x)v_1(\beta) \right]}{KD}\;\;\text{ for } \xi \leq x
\end{align*}$$

$$\begin{align*}
 G(x,\xi) &=\frac{v_2(\alpha)v_1(x) -v_1(\alpha)v_2(x)}{D} R(\beta,\xi)  \\ 
 &= \frac{\left[v_1(x)v_2(\alpha) -v_2(x)v_1(\alpha)\right] \left[v_1(\beta)v_2(\xi) -v_2(\beta)v_1(\xi) \right]}{KD}\;\;\text{ for } x \leq \xi
\end{align*}$$

Then the solution of the two-point boundary value problem @eq-gf-5 can be written in the form

$$ u(x)=\int_\alpha^\beta G(x,\xi)\,f(\xi)\,d\xi $$ {#eq-gf-6}
</font>

---

The function $G(x,\xi)$ is called the **Green's function** of the problem @eq-gf-5. It is symmetric. That is

$$ G(x,\xi)=G(\xi,x) $$

To determine the Green's function, we note that for each $\xi$ it satisfies the following boundary value problem

$$\begin{align*}
 \frac{d}{dx} \left[ p(x) \frac{dG}{dx}\right] &+q(x)G = 0\;\; \text{ for } x \neq \xi \\ 
 \left. G \right|_{x=\alpha} &= \left. G \right|_{x=\beta}=0 \\ 
 \left. G \right|_{x=\xi+0} &- \left. G \right|_{x=\xi -0}=0 \\  
 \left. G' \right|_{x=\xi+0} &-\left. G' \right|_{x=\xi-0}=-\frac{1}{p(\xi)} \\ 
\end{align*}$$

---

**Example** $\text{ }$ Consider the problem

$$\begin{align*}
 u'' &= -f(x)\;\; \text{ for}\; 0 < x < 1\\ 
 u(0) &= 0 \\ 
 u(1) &= 0 \\ 
\end{align*}$$

---

**Solution**

$$\scriptsize\begin{align*}
 G''&= 0\\ 
 &\Downarrow \\
 G &= ax+b\\
 &\Downarrow {\tiny G|_{x=0} \;= G|_{x=1}\;=0} \\ 
 G(x,\xi) &= 
\begin{cases}
 a_1(\xi)\, x& \text{ for } x < \xi \\ 
 a_2(\xi)(1-x)& \text{ for } x > \xi 
\end{cases}\\
 &\Downarrow {\tiny G(x,\xi)=G(\xi,x)}\\
 a_1(\xi)&= A(1 -\xi) \\
 a_2(\xi)&=A\xi \\
 &\Downarrow {\tiny \left. G' \right|_{x=\xi+0} \;\;-\left. G' \right|_{x=\xi-0}\;\;=-1}\\
 -A\xi -A(1 -\xi) &=-1 \rightarrow A = 1 \\
 &\Downarrow \\
 G(x,\xi) &= 
\begin{cases}
 (1-\xi) x& \text{ for } x \leq \xi \\ 
 \xi(1-x)& \text{ for } x \geq \xi 
\end{cases}
\end{align*}$$

The solution is

$$ u(x)= \int_0^x \xi(1-x)\,f(\xi)\,d\xi +\int_x^1 (1-\xi)x \,f(\xi)\,d\xi $$

---

<font size="6px">
Two-point boundary value problems with more general boundary conditions can be treated in the same manner. We consider the problem

$$\begin{align*}
 \frac{d}{dx} &\left[ p(x)\frac{du}{dx} \right] +q(x)u = -f(x)\;\; \text{ for } \alpha < x < \beta \\ 
 -&\mu_1 u'(\alpha) +\sigma_1 u(\alpha)=0 \\
 &\mu_2 u'(\beta) +\sigma_2 u(\beta)=0
\end{align*}$$ {#eq-gf-7}

The Green's function $G(x,\xi)$ is derived as before, provided the condition

$$D\equiv \left[ -\mu_1 v_1'(\alpha) +\sigma_1v_1(\alpha)\right]\left[ \mu_2 v_2'(\beta) +\sigma_2v_2(\beta)\right] \\
  \qquad\quad -\left[ -\mu_1 v_2'(\alpha) +\sigma_1v_2(\alpha)\right]\left[ \mu_2 v_1'(\beta) +\sigma_2v_1(\beta)\right] \neq 0 $$
  
is satisfied. The Green's function $G(x,\xi)$ is the solution of the problem

$$\begin{align*}
 \frac{d}{dx} \left[ p(x) \frac{dG}{dx}\right] &+q(x)G = 0\;\; \text{ for } x \neq \xi \\ 
 -\mu_1\left. G' \right|_{x=\alpha} &+\sigma_1 \left. G\right|_{x=\alpha}  = \mu_2\left. G' \right|_{x=\beta} +\sigma_2\left. G \right|_{x=\beta}=0 \\ 
 \left. G \right|_{x=\xi+0} &- \left. G \right|_{x=\xi -0}=0 \\  
 \left. G' \right|_{x=\xi+0} &-\left. G' \right|_{x=\xi-0}=-\frac{1}{p(\xi)} \\ 
\end{align*}$$

It still satisfies the symmetry relation $G(x,\xi)=G(\xi,x)$
</font>

---

**Example** $\text{ }$ Consider the problem 

$$\begin{align*}
 u'' &= -f(x)\;\; \text{ for } 0 < x < 1\\ 
 u(0) &= 0 \\ 
 u'(1) +\sigma_2 u(1)&= 1 \\ 
\end{align*}$$

---

**Solution** $\text{ } u(x) = w(x) +v(x)$ 

**(1)**
$$\scriptsize\color{green}{\begin{align*}
 w'' &= -f(x)\;\; \text{ for } 0 < x < 1\\ 
 w(0) &= 0 \\ 
 w'(1) +\sigma_2 w(1)&= 0 \\ 
\end{align*}}$$

. . .

$~$

$$\scriptsize\begin{align*}
 G''&= 0\\ 
 &\Downarrow \\
 G &= ax+b\\
 &\Downarrow {\tiny G|_{x=0} \;=\; G'|_{x=1} \;+\,\sigma_2 \, G|_{x=1}\;=0} \\ 
 G(x,\xi) &= 
\begin{cases}
 a_1(\xi)\, x& \text{ for } x < \xi \\ 
 a_2(\xi)\left[1+\sigma_2(1 -x)\right]& \text{ for } x > \xi 
\end{cases}\\
 &\Downarrow {\tiny G(x,\xi)=G(\xi,x)}\\
 a_1(\xi)&= A\left[1 +\sigma_2(1 -\xi)\right] \\
 a_2(\xi)&=A\xi \\
 &\Downarrow {\tiny \left. G' \right|_{x=\xi+0} \;\;-\;\left. G' \right|_{x=\xi-0}\;=-1}\\
 A\xi\cdot-\sigma_2 -A\left[1 +\sigma_2(1 -\xi)\right] &=-1 \rightarrow A = \frac{1}{1+\sigma_2} \\
 \end{align*}$$

---

$$\scriptsize\begin{align*}
  &\Downarrow \\
  G(x,\xi) &= 
  \begin{cases}
    \displaystyle \frac{\left[ 1+\sigma_2(1 -\xi)\right]}{1+\sigma_2} \,x & \text{ for } x \leq \xi \\ \\
    \xi \,\displaystyle \frac{\left[ 1+\sigma_2(1 -x)\right]}{1+\sigma_2} & \text{ for } x \geq \xi \\
  \end{cases}
\end{align*}$$

The solution is

$$ \scriptsize w(x)= \int_0^x \xi \,\frac{\left[ 1+\sigma_2(1 -x)\right]}{1+\sigma_2}\,f(\xi)\,d\xi 
  +\int_x^1 \frac{\left[ 1+\sigma_2(1 -\xi)\right]}{1+\sigma_2} \,x \,f(\xi)\,d\xi $$

**(2)**

$$\scriptsize\begin{align*}
 v'' &= 0\;\; \text{ for } 0 < x < 1\\ 
 v(0) &= 0 \\ 
 v'(1) +\sigma_2 v(1)&= 1 \\ 
\end{align*}$$

$$\scriptsize v(x)=\frac{x}{1+\sigma_2} $$

---

**Example** $\text{ }$ Consider the problem

$$\begin{align*}
 r^2 u'' +2r u' &-n(n +1) u = -r^2 F(r), \; 
 u(R)= 0, \;u \sim \text{bounded}\\ 
\end{align*}$$

---

**Solution**

$$\scriptsize\begin{align*}
 \frac{d}{dr}\left[r^2\frac{dG}{dr} \right] &-n(n+1) G = 0\\ 
 &\Downarrow \\ 
 G &= c_1r^n +c_2r^{-(n+1)} \\ 
 &\Downarrow {\tiny G|_{r=0} \;= \text{ bounded },\; G|_{r=R} \;= 0} \\ 
 G(r,\rho) &= 
\begin{cases}
 a_1(\rho) r^n\, & \text{ for } r < \rho \\ 
 a_2(\rho)\left[\left(\frac{r}{R} \right)^{-(n+1)} -\left(\frac{r}{R} \right)^{n} \right]& \text{ for } r > \rho 
\end{cases}\\ 
 &\Downarrow {\tiny G(r,\rho)=G(\rho,r)}\\
 a_1(\rho)&= A\left[\left(\frac{\rho}{R} \right)^{-(n+1)} -\left(\frac{\rho}{R} \right)^{n} \right] \\
 a_2(\rho)&=A\rho^n \\
 &\Downarrow {\tiny \left. G' \right|_{r=\rho+0} \;\;-\;\left. G' \right|_{r=\rho-0} \;=-1/\rho^2}\\
 \frac{A\rho^n}{R} \left[-(n +1)\left(\frac{\rho}{R} \right)^{-(n+2)} -n \left(\frac{\rho}{R} \right)^{n-1}\right]
 -An\rho^{n-1}&\left[\left(\frac{\rho}{R} \right)^{-(n+1)} -\left(\frac{\rho}{R} \right)^{n}\right] =-\frac{1}{\rho^2} \;\;\rightarrow\;\; A=\frac{1}{(2n +1)R^{n+1}}\\
 &\Downarrow \\
 G(r,\rho) &= 
\begin{cases}
 \frac{1}{(2n +1)R}\left(\frac{r}{R} \right)^n\left[\left(\frac{\rho}{R} \right)^{-(n+1)} -\left(\frac{\rho}{R} \right)^{n} \right] & \text{ for } r \leq \rho \\ 
 \frac{1}{(2n +1)R}\left(\frac{\rho}{R} \right)^n\left[\left(\frac{r}{R} \right)^{-(n+1)} -\left(\frac{r}{R} \right)^{n} \right]& \text{ for } r \geq \rho 
\end{cases}\\ 
\end{align*}$$

---

The solution is

$$ u(x)= \int_0^R G(r,\rho)\,F(\rho) \rho^2 d\rho$$